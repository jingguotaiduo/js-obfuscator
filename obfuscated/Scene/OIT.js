var a663_0x503ec1=a663_0x2636;(function(_0x2f3a12,_0x1e7fae){var _0x33b9e7=a663_0x2636,_0xb4318b=_0x2f3a12();while(!![]){try{var _0x38aabe=-parseInt(_0x33b9e7(0x85))/0x1*(-parseInt(_0x33b9e7(0x9e))/0x2)+-parseInt(_0x33b9e7(0xa8))/0x3*(-parseInt(_0x33b9e7(0xc6))/0x4)+parseInt(_0x33b9e7(0xc5))/0x5+parseInt(_0x33b9e7(0x99))/0x6*(parseInt(_0x33b9e7(0x82))/0x7)+parseInt(_0x33b9e7(0xd7))/0x8*(parseInt(_0x33b9e7(0x89))/0x9)+-parseInt(_0x33b9e7(0x9c))/0xa*(-parseInt(_0x33b9e7(0x9d))/0xb)+parseInt(_0x33b9e7(0xed))/0xc*(-parseInt(_0x33b9e7(0xe9))/0xd);if(_0x38aabe===_0x1e7fae)break;else _0xb4318b['push'](_0xb4318b['shift']());}catch(_0x55f0b4){_0xb4318b['push'](_0xb4318b['shift']());}}}(a663_0x3090,0x59310));import a663_0x12e5bc from'../Core/BoundingRectangle.js';import a663_0x5d97f7 from'../Core/Color.js';import a663_0x5e9db3 from'../Core/defined.js';import a663_0x87f33f from'../Core/destroyObject.js';import a663_0x322839 from'../Core/PixelFormat.js';import a663_0x465207 from'../Core/WebGLConstants.js';import a663_0x421567 from'../Renderer/ClearCommand.js';import a663_0x40a856 from'../Renderer/DrawCommand.js';import a663_0xf1d1c1 from'../Renderer/Framebuffer.js';import a663_0x249924 from'../Renderer/PixelDatatype.js';import a663_0x2b7b8b from'../Renderer/RenderState.js';import a663_0x4b54f5 from'../Renderer/ShaderSource.js';import a663_0x12de44 from'../Renderer/Texture.js';import a663_0x525aa0 from'../Shaders/AdjustTranslucentFS.js';import a663_0x16498d from'../Shaders/CompositeOITFS.js';import a663_0x53269a from'./BlendEquation.js';import a663_0x235cb3 from'./BlendFunction.js';function OIT(_0x536a09){var _0x317711=a663_0x2636;this[_0x317711(0x98)]=![],this[_0x317711(0xd6)]=![];var _0x39fb2=_0x536a09[_0x317711(0xc3)]&&_0x536a09['depthTexture'];this[_0x317711(0xd6)]=_0x536a09[_0x317711(0x8e)]&&_0x39fb2,this[_0x317711(0x98)]=!this[_0x317711(0xd6)]&&_0x39fb2,this[_0x317711(0xe8)]=undefined,this[_0x317711(0xcd)]=undefined,this['_depthStencilTexture']=undefined,this[_0x317711(0x7f)]=undefined,this['_translucentFBO']=undefined,this[_0x317711(0xcc)]=undefined,this[_0x317711(0x95)]=undefined,this[_0x317711(0xd8)]=undefined,this[_0x317711(0x96)]=new a663_0x421567({'color':new a663_0x5d97f7(0x0,0x0,0x0,0x0),'owner':this}),this[_0x317711(0xda)]=new a663_0x421567({'color':new a663_0x5d97f7(0x0,0x0,0x0,0x1),'owner':this}),this[_0x317711(0x93)]=new a663_0x421567({'color':new a663_0x5d97f7(0x0,0x0,0x0,0x0),'owner':this}),this[_0x317711(0xd9)]=new a663_0x421567({'color':new a663_0x5d97f7(0x1,0x1,0x1,0x1),'owner':this}),this[_0x317711(0xc1)]={},this['_alphaRenderStateCache']={},this['_compositeCommand']=undefined,this[_0x317711(0xb2)]=undefined,this[_0x317711(0xb7)]=undefined,this[_0x317711(0xe7)]=new a663_0x12e5bc(),this[_0x317711(0xce)]=undefined,this[_0x317711(0xd4)]=![],this[_0x317711(0x81)]=undefined,this[_0x317711(0xe6)]=![];}function destroyTextures(_0x3503ca){var _0x4f7d61=a663_0x2636;_0x3503ca[_0x4f7d61(0x7f)]=_0x3503ca[_0x4f7d61(0x7f)]&&!_0x3503ca[_0x4f7d61(0x7f)][_0x4f7d61(0x88)]()&&_0x3503ca['_accumulationTexture'][_0x4f7d61(0x8c)](),_0x3503ca['_revealageTexture']=_0x3503ca[_0x4f7d61(0xa4)]&&!_0x3503ca['_revealageTexture'][_0x4f7d61(0x88)]()&&_0x3503ca['_revealageTexture'][_0x4f7d61(0x8c)]();}function destroyFramebuffers(_0x25becc){var _0x5cb70f=a663_0x2636;_0x25becc[_0x5cb70f(0x9f)]=_0x25becc['_translucentFBO']&&!_0x25becc['_translucentFBO'][_0x5cb70f(0x88)]()&&_0x25becc[_0x5cb70f(0x9f)][_0x5cb70f(0x8c)](),_0x25becc[_0x5cb70f(0xcc)]=_0x25becc[_0x5cb70f(0xcc)]&&!_0x25becc[_0x5cb70f(0xcc)][_0x5cb70f(0x88)]()&&_0x25becc['_alphaFBO']['destroy'](),_0x25becc[_0x5cb70f(0x95)]=_0x25becc[_0x5cb70f(0x95)]&&!_0x25becc['_adjustTranslucentFBO']['isDestroyed']()&&_0x25becc[_0x5cb70f(0x95)][_0x5cb70f(0x8c)](),_0x25becc[_0x5cb70f(0xd8)]=_0x25becc[_0x5cb70f(0xd8)]&&!_0x25becc['_adjustAlphaFBO']['isDestroyed']()&&_0x25becc[_0x5cb70f(0xd8)]['destroy']();}function destroyResources(_0x4d3fa6){destroyTextures(_0x4d3fa6),destroyFramebuffers(_0x4d3fa6);}function updateTextures(_0x1d8b89,_0x3f921d,_0x19a4cd,_0x389b3d){var _0x9491d5=a663_0x2636;destroyTextures(_0x1d8b89),_0x1d8b89[_0x9491d5(0x7f)]=new a663_0x12de44({'context':_0x3f921d,'width':_0x19a4cd,'height':_0x389b3d,'pixelFormat':a663_0x322839[_0x9491d5(0xcf)],'pixelDatatype':a663_0x249924[_0x9491d5(0xaf)]});var _0x2a3ed8=new Float32Array(_0x19a4cd*_0x389b3d*0x4);_0x1d8b89['_revealageTexture']=new a663_0x12de44({'context':_0x3f921d,'pixelFormat':a663_0x322839['RGBA'],'pixelDatatype':a663_0x249924[_0x9491d5(0xaf)],'source':{'arrayBufferView':_0x2a3ed8,'width':_0x19a4cd,'height':_0x389b3d},'flipY':![]});}function updateFramebuffers(_0x38998e,_0x3c0b3b){var _0x3b1b2f=a663_0x2636;destroyFramebuffers(_0x38998e);var _0xa53fbe=a663_0x465207[_0x3b1b2f(0x80)],_0x57ea9b=!![];_0x38998e['_translucentMRTSupport']&&(_0x38998e['_translucentFBO']=new a663_0xf1d1c1({'context':_0x3c0b3b,'colorTextures':[_0x38998e['_accumulationTexture'],_0x38998e['_revealageTexture']],'depthStencilTexture':_0x38998e['_depthStencilTexture'],'destroyAttachments':![]}),_0x38998e[_0x3b1b2f(0x95)]=new a663_0xf1d1c1({'context':_0x3c0b3b,'colorTextures':[_0x38998e['_accumulationTexture'],_0x38998e['_revealageTexture']],'destroyAttachments':![]}),(_0x38998e[_0x3b1b2f(0x9f)][_0x3b1b2f(0x91)]!==_0xa53fbe||_0x38998e[_0x3b1b2f(0x95)][_0x3b1b2f(0x91)]!==_0xa53fbe)&&(destroyFramebuffers(_0x38998e),_0x38998e['_translucentMRTSupport']=![]));if(!_0x38998e[_0x3b1b2f(0xd6)]){_0x38998e[_0x3b1b2f(0x9f)]=new a663_0xf1d1c1({'context':_0x3c0b3b,'colorTextures':[_0x38998e['_accumulationTexture']],'depthStencilTexture':_0x38998e[_0x3b1b2f(0xc0)],'destroyAttachments':![]}),_0x38998e[_0x3b1b2f(0xcc)]=new a663_0xf1d1c1({'context':_0x3c0b3b,'colorTextures':[_0x38998e['_revealageTexture']],'depthStencilTexture':_0x38998e[_0x3b1b2f(0xc0)],'destroyAttachments':![]}),_0x38998e[_0x3b1b2f(0x95)]=new a663_0xf1d1c1({'context':_0x3c0b3b,'colorTextures':[_0x38998e['_accumulationTexture']],'destroyAttachments':![]}),_0x38998e[_0x3b1b2f(0xd8)]=new a663_0xf1d1c1({'context':_0x3c0b3b,'colorTextures':[_0x38998e[_0x3b1b2f(0xa4)]],'destroyAttachments':![]});var _0x298cad=_0x38998e['_translucentFBO']['status']===_0xa53fbe,_0x42eb46=_0x38998e[_0x3b1b2f(0xcc)][_0x3b1b2f(0x91)]===_0xa53fbe,_0x305651=_0x38998e[_0x3b1b2f(0x95)][_0x3b1b2f(0x91)]===_0xa53fbe,_0x51449f=_0x38998e[_0x3b1b2f(0xd8)][_0x3b1b2f(0x91)]===_0xa53fbe;(!_0x298cad||!_0x42eb46||!_0x305651||!_0x51449f)&&(destroyResources(_0x38998e),_0x38998e[_0x3b1b2f(0x98)]=![],_0x57ea9b=![]);}return _0x57ea9b;}OIT[a663_0x503ec1(0xe5)][a663_0x503ec1(0xc4)]=function(_0x1a81ec,_0x515292,_0x5be719,_0x2d3939){var _0x318039=a663_0x503ec1;if(!this[_0x318039(0xae)]())return;this[_0x318039(0xe8)]=_0x5be719,this[_0x318039(0xcd)]=_0x5be719[_0x318039(0xbf)](0x0),this[_0x318039(0xc0)]=_0x5be719[_0x318039(0xa3)];var _0x57c145=this[_0x318039(0xcd)][_0x318039(0xd2)],_0x34bc4b=this['_opaqueTexture'][_0x318039(0xe4)],_0x275d3f=this[_0x318039(0x7f)],_0x4f5e47=!a663_0x5e9db3(_0x275d3f)||_0x275d3f['width']!==_0x57c145||_0x275d3f['height']!==_0x34bc4b||_0x2d3939!==this[_0x318039(0xe6)];_0x4f5e47&&updateTextures(this,_0x1a81ec,_0x57c145,_0x34bc4b);if(!a663_0x5e9db3(this['_translucentFBO'])||_0x4f5e47){if(!updateFramebuffers(this,_0x1a81ec))return;}this[_0x318039(0xe6)]=_0x2d3939;var _0x219ce3=this,_0x59576d,_0x2ffa79;!a663_0x5e9db3(this[_0x318039(0xb5)])&&(_0x59576d=new a663_0x4b54f5({'sources':[a663_0x16498d]}),this[_0x318039(0xd6)]&&_0x59576d[_0x318039(0xc8)][_0x318039(0x84)]('MRT'),_0x2ffa79={'u_opaque':function(){return _0x219ce3['_opaqueTexture'];},'u_accumulation':function(){var _0x1317a7=_0x318039;return _0x219ce3[_0x1317a7(0x7f)];},'u_revealage':function(){var _0x1c151a=_0x318039;return _0x219ce3[_0x1c151a(0xa4)];}},this[_0x318039(0xb5)]=_0x1a81ec[_0x318039(0xac)](_0x59576d,{'uniformMap':_0x2ffa79,'owner':this}));if(!a663_0x5e9db3(this[_0x318039(0xb2)])){if(this[_0x318039(0xd6)])_0x59576d=new a663_0x4b54f5({'defines':['MRT'],'sources':[a663_0x525aa0]}),_0x2ffa79={'u_bgColor':function(){var _0x5c8eb9=_0x318039;return _0x219ce3['_translucentMRTClearCommand'][_0x5c8eb9(0xdc)];},'u_depthTexture':function(){var _0x53ef7d=_0x318039;return _0x219ce3[_0x53ef7d(0xc0)];}},this[_0x318039(0xb2)]=_0x1a81ec[_0x318039(0xac)](_0x59576d,{'uniformMap':_0x2ffa79,'owner':this});else this[_0x318039(0x98)]&&(_0x59576d=new a663_0x4b54f5({'sources':[a663_0x525aa0]}),_0x2ffa79={'u_bgColor':function(){var _0x591714=_0x318039;return _0x219ce3[_0x591714(0x93)]['color'];},'u_depthTexture':function(){return _0x219ce3['_depthStencilTexture'];}},this[_0x318039(0xb2)]=_0x1a81ec[_0x318039(0xac)](_0x59576d,{'uniformMap':_0x2ffa79,'owner':this}),_0x2ffa79={'u_bgColor':function(){var _0x4aeb96=_0x318039;return _0x219ce3['_alphaClearCommand'][_0x4aeb96(0xdc)];},'u_depthTexture':function(){var _0xe51e03=_0x318039;return _0x219ce3[_0xe51e03(0xc0)];}},this[_0x318039(0xb7)]=_0x1a81ec[_0x318039(0xac)](_0x59576d,{'uniformMap':_0x2ffa79,'owner':this}));}this[_0x318039(0xe7)]['width']=_0x57c145,this[_0x318039(0xe7)][_0x318039(0xe4)]=_0x34bc4b;var _0x458b9e=!a663_0x12e5bc[_0x318039(0xf1)](this[_0x318039(0xe7)],_0x515292[_0x318039(0xbe)]),_0x4c9ee5=_0x458b9e!==this['_useScissorTest'];this[_0x318039(0xd4)]=_0x458b9e,!a663_0x12e5bc[_0x318039(0xf1)](this['_scissorRectangle'],_0x515292['viewport'])&&(this[_0x318039(0x81)]=a663_0x12e5bc[_0x318039(0x9b)](_0x515292[_0x318039(0xbe)],this[_0x318039(0x81)]),_0x4c9ee5=!![]),(!a663_0x5e9db3(this[_0x318039(0xce)])||!a663_0x12e5bc[_0x318039(0xf1)](this[_0x318039(0xe7)],this['_rs']['viewport'])||_0x4c9ee5)&&(this[_0x318039(0xce)]=a663_0x2b7b8b['fromCache']({'viewport':this[_0x318039(0xe7)],'scissorTest':{'enabled':this[_0x318039(0xd4)],'rectangle':this['_scissorRectangle']}})),a663_0x5e9db3(this[_0x318039(0xb5)])&&(this['_compositeCommand'][_0x318039(0xc9)]=this[_0x318039(0xce)]),this[_0x318039(0xb2)]&&(this[_0x318039(0xb2)][_0x318039(0xc9)]=this[_0x318039(0xce)]),a663_0x5e9db3(this[_0x318039(0xb7)])&&(this[_0x318039(0xb7)]['renderState']=this[_0x318039(0xce)]);};var translucentMRTBlend={'enabled':!![],'color':new a663_0x5d97f7(0x0,0x0,0x0,0x0),'equationRgb':a663_0x53269a['ADD'],'equationAlpha':a663_0x53269a['ADD'],'functionSourceRgb':a663_0x235cb3[a663_0x503ec1(0xb0)],'functionDestinationRgb':a663_0x235cb3[a663_0x503ec1(0xb0)],'functionSourceAlpha':a663_0x235cb3[a663_0x503ec1(0xb6)],'functionDestinationAlpha':a663_0x235cb3[a663_0x503ec1(0x7e)]},translucentColorBlend={'enabled':!![],'color':new a663_0x5d97f7(0x0,0x0,0x0,0x0),'equationRgb':a663_0x53269a[a663_0x503ec1(0xee)],'equationAlpha':a663_0x53269a[a663_0x503ec1(0xee)],'functionSourceRgb':a663_0x235cb3[a663_0x503ec1(0xb0)],'functionDestinationRgb':a663_0x235cb3['ONE'],'functionSourceAlpha':a663_0x235cb3[a663_0x503ec1(0xb0)],'functionDestinationAlpha':a663_0x235cb3[a663_0x503ec1(0xb0)]},translucentAlphaBlend={'enabled':!![],'color':new a663_0x5d97f7(0x0,0x0,0x0,0x0),'equationRgb':a663_0x53269a[a663_0x503ec1(0xee)],'equationAlpha':a663_0x53269a[a663_0x503ec1(0xee)],'functionSourceRgb':a663_0x235cb3[a663_0x503ec1(0xb6)],'functionDestinationRgb':a663_0x235cb3['ONE_MINUS_SOURCE_ALPHA'],'functionSourceAlpha':a663_0x235cb3[a663_0x503ec1(0xb6)],'functionDestinationAlpha':a663_0x235cb3[a663_0x503ec1(0x7e)]};function getTranslucentRenderState(_0x3c9700,_0x3c2cf7,_0xc71589,_0x537854){var _0x1766ee=a663_0x503ec1,_0x2947bf=_0xc71589[_0x537854['id']];if(!a663_0x5e9db3(_0x2947bf)){var _0x4755aa=a663_0x2b7b8b[_0x1766ee(0xa5)](_0x537854);_0x4755aa['depthMask']=![],_0x4755aa[_0x1766ee(0x8d)]=_0x3c2cf7,_0x2947bf=a663_0x2b7b8b[_0x1766ee(0xa7)](_0x4755aa),_0xc71589[_0x537854['id']]=_0x2947bf;}return _0x2947bf;}function a663_0x2636(_0x55a650,_0x43e0a9){var _0x3090b0=a663_0x3090();return a663_0x2636=function(_0x26368f,_0x2b2182){_0x26368f=_0x26368f-0x7e;var _0x1b2056=_0x3090b0[_0x26368f];return _0x1b2056;},a663_0x2636(_0x55a650,_0x43e0a9);}function getTranslucentMRTRenderState(_0x3529ac,_0x203d74,_0x3a6306){var _0x141809=a663_0x503ec1;return getTranslucentRenderState(_0x203d74,translucentMRTBlend,_0x3529ac[_0x141809(0xc1)],_0x3a6306);}function getTranslucentColorRenderState(_0x3478d1,_0x449ee7,_0x356ca3){var _0x3d6c20=a663_0x503ec1;return getTranslucentRenderState(_0x449ee7,translucentColorBlend,_0x3478d1[_0x3d6c20(0xc1)],_0x356ca3);}function getTranslucentAlphaRenderState(_0x4f63b3,_0x1b1b2c,_0x1eeb43){var _0x33e3b1=a663_0x503ec1;return getTranslucentRenderState(_0x1b1b2c,translucentAlphaBlend,_0x4f63b3[_0x33e3b1(0x87)],_0x1eeb43);}var mrtShaderSource=a663_0x503ec1(0xd1)+a663_0x503ec1(0xca)+'\x20\x20\x20\x20float\x20wzi\x20=\x20czm_alphaWeight(ai);\x0a'+'\x20\x20\x20\x20gl_FragData[0]\x20=\x20vec4(Ci\x20*\x20wzi,\x20ai);\x0a'+a663_0x503ec1(0xbc),colorShaderSource='\x20\x20\x20\x20vec3\x20Ci\x20=\x20czm_gl_FragColor.rgb\x20*\x20czm_gl_FragColor.a;\x0a'+a663_0x503ec1(0xca)+a663_0x503ec1(0xb1)+a663_0x503ec1(0x97),alphaShaderSource=a663_0x503ec1(0xca)+'\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(ai);\x0a';function getTranslucentShaderProgram(_0x218b53,_0x37fcf9,_0x49c1f9,_0x2e9e16){var _0x27a548=a663_0x503ec1,_0xf5c9aa=_0x218b53['shaderCache'][_0x27a548(0xd5)](_0x37fcf9,_0x49c1f9);if(!a663_0x5e9db3(_0xf5c9aa)){var _0x450651=_0x37fcf9[_0x27a548(0x94)],_0x21a369=_0x37fcf9[_0x27a548(0xde)][_0x27a548(0x9b)]();_0x21a369[_0x27a548(0xdf)]=_0x21a369['sources'][_0x27a548(0xa0)](function(_0x2bdb43){var _0x4a14be=_0x27a548;return _0x2bdb43=a663_0x4b54f5['replaceMain'](_0x2bdb43,_0x4a14be(0xd3)),_0x2bdb43=_0x2bdb43[_0x4a14be(0xbb)](/gl_FragColor/g,'czm_gl_FragColor'),_0x2bdb43=_0x2bdb43[_0x4a14be(0xbb)](/\bdiscard\b/g,'czm_discard\x20=\x20true'),_0x2bdb43=_0x2bdb43[_0x4a14be(0xbb)](/czm_phong/g,'czm_translucentPhong'),_0x2bdb43;}),_0x21a369[_0x27a548(0xdf)][_0x27a548(0xdd)](0x0,0x0,(_0x2e9e16[_0x27a548(0xaa)]('gl_FragData')!==-0x1?_0x27a548(0xbd):'')+_0x27a548(0xeb)+_0x27a548(0xe0)),_0x21a369[_0x27a548(0xdf)][_0x27a548(0x84)](_0x27a548(0xe3)+'{\x0a'+_0x27a548(0xa9)+_0x27a548(0xb8)+_0x27a548(0xe2)+_0x27a548(0xb3)+_0x27a548(0xb4)+_0x2e9e16+'}\x0a'),_0xf5c9aa=_0x218b53[_0x27a548(0xb9)]['createDerivedShaderProgram'](_0x37fcf9,_0x49c1f9,{'vertexShaderSource':_0x37fcf9['vertexShaderSource'],'fragmentShaderSource':_0x21a369,'attributeLocations':_0x450651});}return _0xf5c9aa;}function a663_0x3090(){var _0x4bf398=['shallowClone','clone','530380eSfevi','132amCpvj','7418ImVdlf','_translucentFBO','map','context','framebuffer','depthStencilTexture','_revealageTexture','getState','_hdr','fromCache','9MzJARM','\x20\x20\x20\x20czm_translucent_main();\x0a','indexOf','executeCommands','createViewportQuadCommand','derivedCommands','isSupported','FLOAT','ONE','\x20\x20\x20\x20float\x20wzi\x20=\x20czm_alphaWeight(ai);\x0a','_adjustTranslucentCommand','\x20\x20\x20\x20\x20\x20\x20\x20discard;\x0a','\x20\x20\x20\x20}\x0a','_compositeCommand','ZERO','_adjustAlphaCommand','\x20\x20\x20\x20if\x20(czm_discard)\x0a','shaderCache','hdr','replace','\x20\x20\x20\x20gl_FragData[1]\x20=\x20vec4(ai\x20*\x20wzi);\x0a','#extension\x20GL_EXT_draw_buffers\x20:\x20enable\x20\x0a','viewport','getColorTexture','_depthStencilTexture','_translucentRenderStateCache','translucentCommand','colorBufferFloat','update','2071115obLZtl','492132fJgIMQ','alphaCommand','defines','renderState','\x20\x20\x20\x20float\x20ai\x20=\x20czm_gl_FragColor.a;\x0a','useLogDepth','_alphaFBO','_opaqueTexture','_rs','RGBA','shadowState','\x20\x20\x20\x20vec3\x20Ci\x20=\x20czm_gl_FragColor.rgb\x20*\x20czm_gl_FragColor.a;\x0a','width','czm_translucent_main','_useScissorTest','getDerivedShaderProgram','_translucentMRTSupport','806072OWORnJ','_adjustAlphaFBO','_alphaClearCommand','_translucentMRTClearCommand','length','color','splice','fragmentShaderSource','sources','bool\x20czm_discard\x20=\x20false;\x0a','translucentMultipass','\x20\x20\x20\x20{\x0a','void\x20main()\x0a','height','prototype','_useHDR','_viewport','_opaqueFBO','23162841zkDNnA','frameState','vec4\x20czm_gl_FragColor;\x0a','createDerivedCommands','12qFMCEq','ADD','execute','logDepth','equals','lightShadowsEnabled','ONE_MINUS_SOURCE_ALPHA','_accumulationTexture','FRAMEBUFFER_COMPLETE','_scissorRectangle','763TIxqcc','shaderProgramId','push','13nGLjhp','shadows','_alphaRenderStateCache','isDestroyed','27UEixoa','unclassifiedCommand','shaderProgram','destroy','blending','drawBuffers','oit','receiveShadows','status','command','_translucentMultipassClearCommand','_attributeLocations','_adjustTranslucentFBO','_opaqueClearCommand','\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(Ci,\x20ai)\x20*\x20wzi;\x0a','_translucentMultipassSupport','20742upWofq'];a663_0x3090=function(){return _0x4bf398;};return a663_0x3090();}function getTranslucentMRTShaderProgram(_0x51de61,_0x1e714c){return getTranslucentShaderProgram(_0x51de61,_0x1e714c,'translucentMRT',mrtShaderSource);}function getTranslucentColorShaderProgram(_0x317952,_0x50ec10){var _0x3f9b85=a663_0x503ec1;return getTranslucentShaderProgram(_0x317952,_0x50ec10,_0x3f9b85(0xe1),colorShaderSource);}function getTranslucentAlphaShaderProgram(_0x9302f4,_0x5f026a){return getTranslucentShaderProgram(_0x9302f4,_0x5f026a,'alphaMultipass',alphaShaderSource);}OIT['prototype'][a663_0x503ec1(0xec)]=function(_0x9be0dd,_0x5d8d48,_0xd1d893){var _0x4b7ace=a663_0x503ec1;!a663_0x5e9db3(_0xd1d893)&&(_0xd1d893={});if(this[_0x4b7ace(0xd6)]){var _0x111192,_0xb5dd52;a663_0x5e9db3(_0xd1d893[_0x4b7ace(0xc2)])&&(_0x111192=_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0x8b)],_0xb5dd52=_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0xc9)]),_0xd1d893['translucentCommand']=a663_0x40a856['shallowClone'](_0x9be0dd,_0xd1d893[_0x4b7ace(0xc2)]),!a663_0x5e9db3(_0x111192)||_0xd1d893[_0x4b7ace(0x83)]!==_0x9be0dd[_0x4b7ace(0x8b)]['id']?(_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0x8b)]=getTranslucentMRTShaderProgram(_0x5d8d48,_0x9be0dd['shaderProgram']),_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0xc9)]=getTranslucentMRTRenderState(this,_0x5d8d48,_0x9be0dd['renderState']),_0xd1d893['shaderProgramId']=_0x9be0dd['shaderProgram']['id']):(_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0x8b)]=_0x111192,_0xd1d893['translucentCommand'][_0x4b7ace(0xc9)]=_0xb5dd52);}else{var _0x14844c,_0x7519bf,_0x52480e,_0xcb832e;a663_0x5e9db3(_0xd1d893[_0x4b7ace(0xc2)])&&(_0x14844c=_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0x8b)],_0x7519bf=_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0xc9)],_0x52480e=_0xd1d893[_0x4b7ace(0xc7)][_0x4b7ace(0x8b)],_0xcb832e=_0xd1d893[_0x4b7ace(0xc7)]['renderState']),_0xd1d893[_0x4b7ace(0xc2)]=a663_0x40a856[_0x4b7ace(0x9a)](_0x9be0dd,_0xd1d893[_0x4b7ace(0xc2)]),_0xd1d893['alphaCommand']=a663_0x40a856[_0x4b7ace(0x9a)](_0x9be0dd,_0xd1d893['alphaCommand']),!a663_0x5e9db3(_0x14844c)||_0xd1d893[_0x4b7ace(0x83)]!==_0x9be0dd[_0x4b7ace(0x8b)]['id']?(_0xd1d893[_0x4b7ace(0xc2)]['shaderProgram']=getTranslucentColorShaderProgram(_0x5d8d48,_0x9be0dd[_0x4b7ace(0x8b)]),_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0xc9)]=getTranslucentColorRenderState(this,_0x5d8d48,_0x9be0dd[_0x4b7ace(0xc9)]),_0xd1d893[_0x4b7ace(0xc7)][_0x4b7ace(0x8b)]=getTranslucentAlphaShaderProgram(_0x5d8d48,_0x9be0dd[_0x4b7ace(0x8b)]),_0xd1d893[_0x4b7ace(0xc7)][_0x4b7ace(0xc9)]=getTranslucentAlphaRenderState(this,_0x5d8d48,_0x9be0dd['renderState']),_0xd1d893[_0x4b7ace(0x83)]=_0x9be0dd[_0x4b7ace(0x8b)]['id']):(_0xd1d893[_0x4b7ace(0xc2)][_0x4b7ace(0x8b)]=_0x14844c,_0xd1d893[_0x4b7ace(0xc2)]['renderState']=_0x7519bf,_0xd1d893[_0x4b7ace(0xc7)][_0x4b7ace(0x8b)]=_0x52480e,_0xd1d893[_0x4b7ace(0xc7)][_0x4b7ace(0xc9)]=_0xcb832e);}return _0xd1d893;};function executeTranslucentCommandsSortedMultipass(_0x48349e,_0x3618de,_0x39a74a,_0x27dfff,_0x21d6ec,_0x84916f){var _0x7ec2bb=a663_0x503ec1,_0x265c31,_0x54ed63,_0x37774e,_0x588ecc=_0x3618de[_0x7ec2bb(0xa1)],_0x399150=_0x3618de['frameState'][_0x7ec2bb(0xcb)],_0x5715dd=_0x3618de[_0x7ec2bb(0xa6)],_0x3ae900=_0x27dfff[_0x7ec2bb(0xa2)],_0x4e5977=_0x21d6ec[_0x7ec2bb(0xdb)],_0x180426=_0x3618de[_0x7ec2bb(0xea)][_0x7ec2bb(0xd0)][_0x7ec2bb(0xf2)];_0x27dfff['framebuffer']=_0x48349e[_0x7ec2bb(0x95)],_0x48349e[_0x7ec2bb(0xb2)][_0x7ec2bb(0xef)](_0x588ecc,_0x27dfff),_0x27dfff[_0x7ec2bb(0xa2)]=_0x48349e[_0x7ec2bb(0xd8)],_0x48349e[_0x7ec2bb(0xb7)][_0x7ec2bb(0xef)](_0x588ecc,_0x27dfff);var _0x33eb2a=_0x48349e['_opaqueFBO'];_0x27dfff['framebuffer']=_0x48349e[_0x7ec2bb(0x9f)];for(_0x37774e=0x0;_0x37774e<_0x4e5977;++_0x37774e){_0x265c31=_0x21d6ec[_0x37774e],_0x265c31=_0x399150?_0x265c31[_0x7ec2bb(0xad)][_0x7ec2bb(0xf0)]['command']:_0x265c31,_0x265c31=_0x5715dd?_0x265c31['derivedCommands'][_0x7ec2bb(0xba)][_0x7ec2bb(0x92)]:_0x265c31,_0x54ed63=_0x180426&&_0x265c31[_0x7ec2bb(0x90)]?_0x265c31[_0x7ec2bb(0xad)]['oit'][_0x7ec2bb(0x86)]['translucentCommand']:_0x265c31[_0x7ec2bb(0xad)][_0x7ec2bb(0x8f)][_0x7ec2bb(0xc2)],_0x39a74a(_0x54ed63,_0x3618de,_0x588ecc,_0x27dfff,_0x33eb2a);}a663_0x5e9db3(_0x84916f)&&(_0x265c31=_0x84916f[_0x7ec2bb(0x8a)],_0x54ed63=_0x180426&&_0x265c31[_0x7ec2bb(0x90)]?_0x265c31['derivedCommands'][_0x7ec2bb(0x8f)][_0x7ec2bb(0x86)][_0x7ec2bb(0xc2)]:_0x265c31[_0x7ec2bb(0xad)]['oit'][_0x7ec2bb(0xc2)],_0x39a74a(_0x54ed63,_0x3618de,_0x588ecc,_0x27dfff,_0x33eb2a));_0x27dfff[_0x7ec2bb(0xa2)]=_0x48349e[_0x7ec2bb(0xcc)];for(_0x37774e=0x0;_0x37774e<_0x4e5977;++_0x37774e){_0x265c31=_0x21d6ec[_0x37774e],_0x265c31=_0x399150?_0x265c31[_0x7ec2bb(0xad)][_0x7ec2bb(0xf0)][_0x7ec2bb(0x92)]:_0x265c31,_0x265c31=_0x5715dd?_0x265c31[_0x7ec2bb(0xad)]['hdr'][_0x7ec2bb(0x92)]:_0x265c31,_0x54ed63=_0x180426&&_0x265c31['receiveShadows']?_0x265c31['derivedCommands'][_0x7ec2bb(0x8f)][_0x7ec2bb(0x86)][_0x7ec2bb(0xc7)]:_0x265c31['derivedCommands'][_0x7ec2bb(0x8f)]['alphaCommand'],_0x39a74a(_0x54ed63,_0x3618de,_0x588ecc,_0x27dfff,_0x33eb2a);}a663_0x5e9db3(_0x84916f)&&(_0x265c31=_0x84916f[_0x7ec2bb(0x8a)],_0x54ed63=_0x180426&&_0x265c31['receiveShadows']?_0x265c31[_0x7ec2bb(0xad)]['oit'][_0x7ec2bb(0x86)][_0x7ec2bb(0xc7)]:_0x265c31[_0x7ec2bb(0xad)][_0x7ec2bb(0x8f)]['alphaCommand'],_0x39a74a(_0x54ed63,_0x3618de,_0x588ecc,_0x27dfff,_0x33eb2a)),_0x27dfff[_0x7ec2bb(0xa2)]=_0x3ae900;}function executeTranslucentCommandsSortedMRT(_0x4b37bf,_0x438044,_0x1f8851,_0x124e80,_0x2ecfc5,_0x4e799f){var _0x2edbfa=a663_0x503ec1,_0x162156=_0x438044[_0x2edbfa(0xa1)],_0x2c5cea=_0x438044[_0x2edbfa(0xea)]['useLogDepth'],_0x29b586=_0x438044[_0x2edbfa(0xa6)],_0x37a0a6=_0x124e80['framebuffer'],_0x54dbac=_0x2ecfc5[_0x2edbfa(0xdb)],_0x23c389=_0x438044['frameState'][_0x2edbfa(0xd0)][_0x2edbfa(0xf2)];_0x124e80['framebuffer']=_0x4b37bf[_0x2edbfa(0x95)],_0x4b37bf['_adjustTranslucentCommand']['execute'](_0x162156,_0x124e80);var _0x53d9eb=_0x4b37bf['_opaqueFBO'];_0x124e80[_0x2edbfa(0xa2)]=_0x4b37bf[_0x2edbfa(0x9f)];var _0x53d26d,_0xd153f8;for(var _0x386d18=0x0;_0x386d18<_0x54dbac;++_0x386d18){_0x53d26d=_0x2ecfc5[_0x386d18],_0x53d26d=_0x2c5cea?_0x53d26d[_0x2edbfa(0xad)][_0x2edbfa(0xf0)]['command']:_0x53d26d,_0x53d26d=_0x29b586?_0x53d26d[_0x2edbfa(0xad)][_0x2edbfa(0xba)]['command']:_0x53d26d,_0xd153f8=_0x23c389&&_0x53d26d['receiveShadows']?_0x53d26d[_0x2edbfa(0xad)]['oit'][_0x2edbfa(0x86)]['translucentCommand']:_0x53d26d[_0x2edbfa(0xad)]['oit'][_0x2edbfa(0xc2)],_0x1f8851(_0xd153f8,_0x438044,_0x162156,_0x124e80,_0x53d9eb);}a663_0x5e9db3(_0x4e799f)&&(_0x53d26d=_0x4e799f[_0x2edbfa(0x8a)],_0xd153f8=_0x23c389&&_0x53d26d[_0x2edbfa(0x90)]?_0x53d26d['derivedCommands'][_0x2edbfa(0x8f)][_0x2edbfa(0x86)][_0x2edbfa(0xc2)]:_0x53d26d[_0x2edbfa(0xad)]['oit'][_0x2edbfa(0xc2)],_0x1f8851(_0xd153f8,_0x438044,_0x162156,_0x124e80,_0x53d9eb)),_0x124e80[_0x2edbfa(0xa2)]=_0x37a0a6;}OIT[a663_0x503ec1(0xe5)][a663_0x503ec1(0xab)]=function(_0x31c380,_0x474fec,_0x5ed671,_0x2d8e4f,_0x2d636d){var _0x339239=a663_0x503ec1;if(this[_0x339239(0xd6)]){executeTranslucentCommandsSortedMRT(this,_0x31c380,_0x474fec,_0x5ed671,_0x2d8e4f,_0x2d636d);return;}executeTranslucentCommandsSortedMultipass(this,_0x31c380,_0x474fec,_0x5ed671,_0x2d8e4f,_0x2d636d);},OIT[a663_0x503ec1(0xe5)][a663_0x503ec1(0xef)]=function(_0x23ed3f,_0x35e396){var _0x5b207e=a663_0x503ec1;this[_0x5b207e(0xb5)][_0x5b207e(0xef)](_0x23ed3f,_0x35e396);},OIT[a663_0x503ec1(0xe5)]['clear']=function(_0x437af1,_0x55f309,_0x519e3c){var _0x382c35=a663_0x503ec1,_0x370d38=_0x55f309[_0x382c35(0xa2)];_0x55f309[_0x382c35(0xa2)]=this[_0x382c35(0xe8)],a663_0x5d97f7['clone'](_0x519e3c,this['_opaqueClearCommand'][_0x382c35(0xdc)]),this[_0x382c35(0x96)]['execute'](_0x437af1,_0x55f309),_0x55f309[_0x382c35(0xa2)]=this['_translucentFBO'];var _0x8856f9=this[_0x382c35(0xd6)]?this['_translucentMRTClearCommand']:this[_0x382c35(0x93)];_0x8856f9['execute'](_0x437af1,_0x55f309),this['_translucentMultipassSupport']&&(_0x55f309['framebuffer']=this['_alphaFBO'],this['_alphaClearCommand']['execute'](_0x437af1,_0x55f309)),_0x55f309[_0x382c35(0xa2)]=_0x370d38;},OIT[a663_0x503ec1(0xe5)]['isSupported']=function(){return this['_translucentMRTSupport']||this['_translucentMultipassSupport'];},OIT['prototype'][a663_0x503ec1(0x88)]=function(){return![];},OIT['prototype']['destroy']=function(){var _0x44a8d0=a663_0x503ec1;return destroyResources(this),a663_0x5e9db3(this[_0x44a8d0(0xb5)])&&(this[_0x44a8d0(0xb5)][_0x44a8d0(0x8b)]=this['_compositeCommand'][_0x44a8d0(0x8b)]&&this['_compositeCommand'][_0x44a8d0(0x8b)][_0x44a8d0(0x8c)]()),a663_0x5e9db3(this[_0x44a8d0(0xb2)])&&(this[_0x44a8d0(0xb2)]['shaderProgram']=this['_adjustTranslucentCommand'][_0x44a8d0(0x8b)]&&this[_0x44a8d0(0xb2)][_0x44a8d0(0x8b)][_0x44a8d0(0x8c)]()),a663_0x5e9db3(this[_0x44a8d0(0xb7)])&&(this[_0x44a8d0(0xb7)][_0x44a8d0(0x8b)]=this[_0x44a8d0(0xb7)][_0x44a8d0(0x8b)]&&this[_0x44a8d0(0xb7)][_0x44a8d0(0x8b)]['destroy']()),a663_0x87f33f(this);};export default OIT;