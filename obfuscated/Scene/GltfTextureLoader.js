var a555_0x435ab0=a555_0xb3c3;(function(_0x1a8bba,_0x1502d9){var _0xb0fbd0=a555_0xb3c3,_0x35d539=_0x1a8bba();while(!![]){try{var _0x2414ed=-parseInt(_0xb0fbd0(0x163))/0x1+parseInt(_0xb0fbd0(0x13f))/0x2+parseInt(_0xb0fbd0(0x150))/0x3*(-parseInt(_0xb0fbd0(0x187))/0x4)+-parseInt(_0xb0fbd0(0x16a))/0x5*(-parseInt(_0xb0fbd0(0x181))/0x6)+parseInt(_0xb0fbd0(0x151))/0x7*(-parseInt(_0xb0fbd0(0x16c))/0x8)+parseInt(_0xb0fbd0(0x14a))/0x9*(-parseInt(_0xb0fbd0(0x172))/0xa)+-parseInt(_0xb0fbd0(0x177))/0xb*(-parseInt(_0xb0fbd0(0x147))/0xc);if(_0x2414ed===_0x1502d9)break;else _0x35d539['push'](_0x35d539['shift']());}catch(_0x3b0a86){_0x35d539['push'](_0x35d539['shift']());}}}(a555_0x18b2,0x4e14c));import a555_0x11488b from'../Core/Check.js';import a555_0x3bc2d3 from'../Core/Math.js';import a555_0xaec803 from'../Core/defaultValue.js';import a555_0xc1a823 from'../Core/defined.js';import a555_0x19aa47 from'../Core/PixelFormat.js';import a555_0x3d5217 from'../Renderer/Texture.js';import a555_0x346302 from'../Renderer/TextureMinificationFilter.js';function a555_0x18b2(){var _0x1af9a0=['PROCESSING','gltf','height','createElement','webgl2','then','FAILED','_resourceCache','108263WatgWY','set','asynchronous','_imageId','LOADING','typeOf','options.resourceCache','390485leMUDl','constructor','4819040DhtEHb','process','baseResource','nextPowerOfTwo','isCompressedFormat','_state','110HaJKGC','_texture','texture','frameState','getContext','55vriRDJ','resolve','LINEAR_MIPMAP_NEAREST','_imageLoader','_textureInfo','cacheKey','execute','reject','destroy','wrapT','42sggUNP','Compressed\x20texture\x20uses\x20REPEAT\x20or\x20MIRRORED_REPEAT\x20texture\x20wrap\x20mode\x20and\x20dimensions\x20are\x20not\x20powers\x20of\x20two.\x20The\x20texture\x20may\x20be\x20rendered\x20incorrectly.','wrapS','isPowerOfTwo','getImageIdFromTexture','promise','20sJuSPM','resourceCache','defineProperties','LINEAR_MIPMAP_LINEAR','context','UNLOADED','_mipLevels','mipLevels','REPEAT','warn','_baseResource','429166vaIQoZ','_image','READY','options.textureInfo','create','MIRRORED_REPEAT','TEXTURE','_cacheKey','2418924lQYqOR','width','object','446751ZdUcvt','Failed\x20to\x20load\x20texture','prototype','isDestroyed','_promise','image','115593DcNEjH','7BJjJYM','canvas','NEAREST_MIPMAP_LINEAR','_asynchronous','minificationFilter','supportedImageFormats','unload','textureInfo','_gltf','_gltfResource'];a555_0x18b2=function(){return _0x1af9a0;};return a555_0x18b2();}import a555_0x1b8ad9 from'../Renderer/TextureWrap.js';function a555_0xb3c3(_0x3a66e5,_0x41c7ee){var _0x18b275=a555_0x18b2();return a555_0xb3c3=function(_0xb3c36b,_0x3478dd){_0xb3c36b=_0xb3c36b-0x137;var _0x4781cc=_0x18b275[_0xb3c36b];return _0x4781cc;},a555_0xb3c3(_0x3a66e5,_0x41c7ee);}import a555_0x523e32 from'../ThirdParty/when.js';import a555_0x592cbb from'./GltfLoaderUtil.js';import a555_0xf507a4 from'./JobType.js';import a555_0x6e7bf7 from'./ResourceLoader.js';import a555_0xfbfabf from'./ResourceLoaderState.js';export default function GltfTextureLoader(_0x3e6539){var _0x30e2a0=a555_0xb3c3;_0x3e6539=a555_0xaec803(_0x3e6539,a555_0xaec803['EMPTY_OBJECT']);var _0x3f5c88=_0x3e6539[_0x30e2a0(0x188)],_0x11c9d5=_0x3e6539[_0x30e2a0(0x15c)],_0x5b2c9c=_0x3e6539[_0x30e2a0(0x158)],_0x42869d=_0x3e6539['gltfResource'],_0xb9c6ae=_0x3e6539[_0x30e2a0(0x16e)],_0x43d6ed=_0x3e6539[_0x30e2a0(0x156)],_0x272144=_0x3e6539[_0x30e2a0(0x17c)],_0x11ce16=a555_0xaec803(_0x3e6539[_0x30e2a0(0x165)],!![]);a555_0x11488b[_0x30e2a0(0x168)]['func'](_0x30e2a0(0x169),_0x3f5c88),a555_0x11488b[_0x30e2a0(0x168)][_0x30e2a0(0x149)]('options.gltf',_0x11c9d5),a555_0x11488b['typeOf']['object'](_0x30e2a0(0x142),_0x5b2c9c),a555_0x11488b['typeOf'][_0x30e2a0(0x149)]('options.gltfResource',_0x42869d),a555_0x11488b[_0x30e2a0(0x168)][_0x30e2a0(0x149)]('options.baseResource',_0xb9c6ae),a555_0x11488b[_0x30e2a0(0x168)][_0x30e2a0(0x149)]('options.supportedImageFormats',_0x43d6ed);var _0x5d5daf=_0x5b2c9c['index'],_0x1b101c=a555_0x592cbb[_0x30e2a0(0x185)]({'gltf':_0x11c9d5,'textureId':_0x5d5daf,'supportedImageFormats':_0x43d6ed});this[_0x30e2a0(0x162)]=_0x3f5c88,this[_0x30e2a0(0x159)]=_0x11c9d5,this[_0x30e2a0(0x17b)]=_0x5b2c9c,this[_0x30e2a0(0x166)]=_0x1b101c,this[_0x30e2a0(0x15a)]=_0x42869d,this[_0x30e2a0(0x13e)]=_0xb9c6ae,this[_0x30e2a0(0x146)]=_0x272144,this[_0x30e2a0(0x154)]=_0x11ce16,this[_0x30e2a0(0x17a)]=undefined,this[_0x30e2a0(0x140)]=undefined,this[_0x30e2a0(0x13a)]=undefined,this['_texture']=undefined,this[_0x30e2a0(0x171)]=a555_0xfbfabf[_0x30e2a0(0x139)],this[_0x30e2a0(0x14e)]=a555_0x523e32['defer']();}a555_0xc1a823(Object[a555_0x435ab0(0x143)])&&(GltfTextureLoader[a555_0x435ab0(0x14c)]=Object[a555_0x435ab0(0x143)](a555_0x6e7bf7[a555_0x435ab0(0x14c)]),GltfTextureLoader[a555_0x435ab0(0x14c)][a555_0x435ab0(0x16b)]=GltfTextureLoader);Object[a555_0x435ab0(0x189)](GltfTextureLoader['prototype'],{'promise':{'get':function(){var _0xe09fe4=a555_0x435ab0;return this['_promise'][_0xe09fe4(0x186)];}},'cacheKey':{'get':function(){return this['_cacheKey'];}},'texture':{'get':function(){return this['_texture'];}}}),GltfTextureLoader[a555_0x435ab0(0x14c)]['load']=function(){var _0x164921=a555_0x435ab0,_0x5a7368=this['_resourceCache'],_0xe1645a=_0x5a7368['loadImage']({'gltf':this[_0x164921(0x159)],'imageId':this[_0x164921(0x166)],'gltfResource':this['_gltfResource'],'baseResource':this[_0x164921(0x13e)]});this['_imageLoader']=_0xe1645a,this['_state']=a555_0xfbfabf[_0x164921(0x167)];var _0xce0e8b=this;_0xe1645a[_0x164921(0x186)][_0x164921(0x160)](function(){var _0x46a63e=_0x164921;if(_0xce0e8b[_0x46a63e(0x14d)]())return;_0xce0e8b[_0x46a63e(0x140)]=_0xe1645a[_0x46a63e(0x14f)],_0xce0e8b[_0x46a63e(0x13a)]=_0xe1645a[_0x46a63e(0x13b)],_0xce0e8b[_0x46a63e(0x171)]=a555_0xfbfabf[_0x46a63e(0x15b)];})['otherwise'](function(_0x53dfc7){var _0x18808b=_0x164921;if(_0xce0e8b[_0x18808b(0x14d)]())return;_0xce0e8b[_0x18808b(0x157)](),_0xce0e8b[_0x18808b(0x171)]=a555_0xfbfabf[_0x18808b(0x161)];var _0x405da6=_0x18808b(0x14b);_0xce0e8b[_0x18808b(0x14e)][_0x18808b(0x17e)](_0xce0e8b['getError'](_0x405da6,_0x53dfc7));});};function CreateTextureJob(){var _0xa47398=a555_0x435ab0;this[_0xa47398(0x15c)]=undefined,this['textureInfo']=undefined,this[_0xa47398(0x14f)]=undefined,this[_0xa47398(0x138)]=undefined,this['texture']=undefined;}CreateTextureJob[a555_0x435ab0(0x14c)][a555_0x435ab0(0x164)]=function(_0x378850,_0x11dd4a,_0x5d0019,_0x172821,_0x369e11){var _0x473f1b=a555_0x435ab0;this[_0x473f1b(0x15c)]=_0x378850,this[_0x473f1b(0x158)]=_0x11dd4a,this['image']=_0x5d0019,this[_0x473f1b(0x13b)]=_0x172821,this[_0x473f1b(0x138)]=_0x369e11;},CreateTextureJob[a555_0x435ab0(0x14c)][a555_0x435ab0(0x17d)]=function(){var _0x24708e=a555_0x435ab0;this['texture']=createTexture(this[_0x24708e(0x15c)],this[_0x24708e(0x158)],this[_0x24708e(0x14f)],this[_0x24708e(0x13b)],this[_0x24708e(0x138)]);};function resizeImageToNextPowerOfTwo(_0x46feec){var _0x39a173=a555_0x435ab0,_0x486e1c=document[_0x39a173(0x15e)](_0x39a173(0x152));_0x486e1c[_0x39a173(0x148)]=a555_0x3bc2d3[_0x39a173(0x16f)](_0x46feec[_0x39a173(0x148)]),_0x486e1c[_0x39a173(0x15d)]=a555_0x3bc2d3[_0x39a173(0x16f)](_0x46feec['height']);var _0x886894=_0x486e1c[_0x39a173(0x176)]('2d');return _0x886894['drawImage'](_0x46feec,0x0,0x0,_0x46feec[_0x39a173(0x148)],_0x46feec['height'],0x0,0x0,_0x486e1c[_0x39a173(0x148)],_0x486e1c[_0x39a173(0x15d)]),_0x486e1c;}function createTexture(_0x35a3b5,_0x8ae6c0,_0x191c35,_0x50a9b4,_0x1fbffb){var _0x5433c6=a555_0x435ab0,_0x3fbdb0=_0x191c35['internalFormat'],_0x3499e4=![];a555_0x19aa47[_0x5433c6(0x170)](_0x3fbdb0)&&!a555_0xc1a823(_0x50a9b4)&&(_0x3499e4=!![]);var _0x20d6d2=a555_0x592cbb['createSampler']({'gltf':_0x35a3b5,'textureInfo':_0x8ae6c0,'compressedTextureNoMipmap':_0x3499e4}),_0x3c8f00=_0x20d6d2[_0x5433c6(0x155)],_0x3467df=_0x20d6d2[_0x5433c6(0x183)],_0x34d098=_0x20d6d2[_0x5433c6(0x180)],_0x27308b=_0x3c8f00===a555_0x346302['NEAREST_MIPMAP_NEAREST']||_0x3c8f00===a555_0x346302[_0x5433c6(0x153)]||_0x3c8f00===a555_0x346302[_0x5433c6(0x179)]||_0x3c8f00===a555_0x346302[_0x5433c6(0x137)],_0x2d7f9d=!a555_0xc1a823(_0x3fbdb0)&&_0x27308b,_0x197194=_0x2d7f9d||_0x3467df===a555_0x1b8ad9['REPEAT']||_0x3467df===a555_0x1b8ad9[_0x5433c6(0x144)]||_0x34d098===a555_0x1b8ad9[_0x5433c6(0x13c)]||_0x34d098===a555_0x1b8ad9[_0x5433c6(0x144)],_0x53e2bb=!a555_0x3bc2d3[_0x5433c6(0x184)](_0x191c35[_0x5433c6(0x148)])||!a555_0x3bc2d3[_0x5433c6(0x184)](_0x191c35[_0x5433c6(0x15d)]),_0x30d073=_0x197194&&_0x53e2bb,_0x4e29bf;return a555_0xc1a823(_0x3fbdb0)?(!_0x1fbffb[_0x5433c6(0x15f)]&&a555_0x19aa47[_0x5433c6(0x170)](_0x3fbdb0)&&_0x53e2bb&&_0x197194&&console[_0x5433c6(0x13d)](_0x5433c6(0x182)),_0x4e29bf=a555_0x3d5217[_0x5433c6(0x143)]({'context':_0x1fbffb,'source':{'arrayBufferView':_0x191c35['bufferView'],'mipLevels':_0x50a9b4},'width':_0x191c35[_0x5433c6(0x148)],'height':_0x191c35[_0x5433c6(0x15d)],'pixelFormat':_0x191c35['internalFormat'],'sampler':_0x20d6d2})):(_0x30d073&&(_0x191c35=resizeImageToNextPowerOfTwo(_0x191c35)),_0x4e29bf=a555_0x3d5217[_0x5433c6(0x143)]({'context':_0x1fbffb,'source':_0x191c35,'sampler':_0x20d6d2,'flipY':![],'skipColorSpaceConversion':!![]})),_0x2d7f9d&&_0x4e29bf['generateMipmap'](),_0x4e29bf;}var scratchTextureJob=new CreateTextureJob();GltfTextureLoader[a555_0x435ab0(0x14c)][a555_0x435ab0(0x16d)]=function(_0x1acf0f){var _0x17f8d6=a555_0x435ab0;a555_0x11488b['typeOf']['object'](_0x17f8d6(0x175),_0x1acf0f);if(a555_0xc1a823(this[_0x17f8d6(0x173)]))return;if(!a555_0xc1a823(this[_0x17f8d6(0x140)]))return;var _0x158d26;if(this[_0x17f8d6(0x154)]){var _0x43592c=scratchTextureJob;_0x43592c['set'](this['_gltf'],this['_textureInfo'],this[_0x17f8d6(0x140)],this['_mipLevels'],_0x1acf0f['context']);var _0x3bfe09=_0x1acf0f['jobScheduler'];if(!_0x3bfe09[_0x17f8d6(0x17d)](_0x43592c,a555_0xf507a4[_0x17f8d6(0x145)]))return;_0x158d26=_0x43592c[_0x17f8d6(0x174)];}else _0x158d26=createTexture(this[_0x17f8d6(0x159)],this[_0x17f8d6(0x17b)],this[_0x17f8d6(0x140)],this[_0x17f8d6(0x13a)],_0x1acf0f[_0x17f8d6(0x138)]);this['unload'](),this[_0x17f8d6(0x173)]=_0x158d26,this[_0x17f8d6(0x171)]=a555_0xfbfabf[_0x17f8d6(0x141)],this[_0x17f8d6(0x14e)][_0x17f8d6(0x178)](this);},GltfTextureLoader[a555_0x435ab0(0x14c)][a555_0x435ab0(0x157)]=function(){var _0x553e5d=a555_0x435ab0;a555_0xc1a823(this[_0x553e5d(0x173)])&&this[_0x553e5d(0x173)][_0x553e5d(0x17f)](),a555_0xc1a823(this['_imageLoader'])&&this[_0x553e5d(0x162)]['unload'](this[_0x553e5d(0x17a)]),this[_0x553e5d(0x17a)]=undefined,this['_image']=undefined,this['_mipLevels']=undefined,this['_texture']=undefined,this[_0x553e5d(0x159)]=undefined;};