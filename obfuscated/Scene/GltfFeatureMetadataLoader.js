var a526_0x5164e0=a526_0x4f2c;(function(_0x174799,_0x22d395){var _0xde47cc=a526_0x4f2c,_0x52d56a=_0x174799();while(!![]){try{var _0x1d4297=parseInt(_0xde47cc(0x18f))/0x1*(parseInt(_0xde47cc(0x194))/0x2)+parseInt(_0xde47cc(0x19d))/0x3*(-parseInt(_0xde47cc(0x193))/0x4)+parseInt(_0xde47cc(0x177))/0x5+-parseInt(_0xde47cc(0x188))/0x6*(parseInt(_0xde47cc(0x181))/0x7)+parseInt(_0xde47cc(0x199))/0x8+-parseInt(_0xde47cc(0x168))/0x9*(-parseInt(_0xde47cc(0x161))/0xa)+parseInt(_0xde47cc(0x178))/0xb*(-parseInt(_0xde47cc(0x174))/0xc);if(_0x1d4297===_0x22d395)break;else _0x52d56a['push'](_0x52d56a['shift']());}catch(_0x2afc61){_0x52d56a['push'](_0x52d56a['shift']());}}}(a526_0x452d,0xeb22f));import a526_0x21f92f from'../Core/Check.js';import a526_0x906e0e from'../Core/defaultValue.js';import a526_0x5f0c3d from'../Core/defined.js';import a526_0x1b5df8 from'../Core/DeveloperError.js';import a526_0x1789fc from'../ThirdParty/when.js';import a526_0x3b43f5 from'./parseFeatureMetadata.js';import a526_0x4f9920 from'./parseFeatureMetadataLegacy.js';import a526_0x1f7bab from'./ResourceCache.js';import a526_0x51e3bf from'./ResourceLoader.js';import a526_0x1d5eeb from'./ResourceLoaderState.js';export default function GltfFeatureMetadataLoader(_0x48547d){var _0x4662ae=a526_0x4f2c;_0x48547d=a526_0x906e0e(_0x48547d,a526_0x906e0e[_0x4662ae(0x165)]);var _0x5ae731=_0x48547d[_0x4662ae(0x186)],_0x2c2d97=_0x48547d[_0x4662ae(0x18d)],_0x5b0f6c=_0x48547d[_0x4662ae(0x15a)],_0x55709b=_0x48547d['gltfResource'],_0x4a2806=_0x48547d[_0x4662ae(0x166)],_0x2c9d98=_0x48547d[_0x4662ae(0x17b)],_0x498575=_0x48547d[_0x4662ae(0x192)],_0x58d944=a526_0x906e0e(_0x48547d[_0x4662ae(0x15d)],!![]);a526_0x21f92f['typeOf']['object'](_0x4662ae(0x18a),_0x5ae731),a526_0x21f92f[_0x4662ae(0x157)][_0x4662ae(0x191)](_0x4662ae(0x195),_0x55709b),a526_0x21f92f[_0x4662ae(0x157)]['object'](_0x4662ae(0x169),_0x4a2806),a526_0x21f92f['typeOf'][_0x4662ae(0x191)]('options.supportedImageFormats',_0x2c9d98);if(!a526_0x5f0c3d(_0x48547d[_0x4662ae(0x18d)])&&!a526_0x5f0c3d(_0x48547d[_0x4662ae(0x15a)]))throw new a526_0x1b5df8(_0x4662ae(0x187));this[_0x4662ae(0x190)]=_0x55709b,this[_0x4662ae(0x152)]=_0x4a2806,this[_0x4662ae(0x162)]=_0x5ae731,this[_0x4662ae(0x167)]=_0x2c2d97,this[_0x4662ae(0x171)]=_0x5b0f6c,this['_supportedImageFormats']=_0x2c9d98,this['_cacheKey']=_0x498575,this['_asynchronous']=_0x58d944,this[_0x4662ae(0x16e)]=[],this['_textureLoaders']=[],this['_schemaLoader']=undefined,this['_featureMetadata']=undefined,this[_0x4662ae(0x17c)]=a526_0x1d5eeb[_0x4662ae(0x19c)],this[_0x4662ae(0x19e)]=a526_0x1789fc[_0x4662ae(0x16f)]();}a526_0x5f0c3d(Object[a526_0x5164e0(0x163)])&&(GltfFeatureMetadataLoader[a526_0x5164e0(0x198)]=Object[a526_0x5164e0(0x163)](a526_0x51e3bf['prototype']),GltfFeatureMetadataLoader[a526_0x5164e0(0x198)]['constructor']=GltfFeatureMetadataLoader);Object[a526_0x5164e0(0x16c)](GltfFeatureMetadataLoader['prototype'],{'promise':{'get':function(){var _0x4cb9b5=a526_0x5164e0;return this[_0x4cb9b5(0x19e)]['promise'];}},'cacheKey':{'get':function(){var _0x26558e=a526_0x5164e0;return this[_0x26558e(0x159)];}},'featureMetadata':{'get':function(){var _0x1d39aa=a526_0x5164e0;return this[_0x1d39aa(0x164)];}}}),GltfFeatureMetadataLoader[a526_0x5164e0(0x198)][a526_0x5164e0(0x19a)]=function(){var _0xa44d36=a526_0x5164e0,_0x3c0761=loadBufferViews(this),_0x3b68b9=loadTextures(this),_0x361e1f=loadSchema(this);this[_0xa44d36(0x162)]=undefined,this[_0xa44d36(0x17c)]=a526_0x1d5eeb[_0xa44d36(0x18c)];var _0xa6213a=this;a526_0x1789fc[_0xa44d36(0x183)]([_0x3c0761,_0x3b68b9,_0x361e1f])['then'](function(_0x498ec5){var _0xc5fc40=_0xa44d36;if(_0xa6213a[_0xc5fc40(0x155)]())return;var _0x1784a4=_0x498ec5[0x0],_0x3d291c=_0x498ec5[0x1],_0x344e1d=_0x498ec5[0x2];a526_0x5f0c3d(_0xa6213a['_extension'])?_0xa6213a[_0xc5fc40(0x164)]=a526_0x3b43f5({'extension':_0xa6213a[_0xc5fc40(0x167)],'schema':_0x344e1d,'bufferViews':_0x1784a4,'textures':_0x3d291c}):_0xa6213a[_0xc5fc40(0x164)]=a526_0x4f9920({'extension':_0xa6213a['_extensionLegacy'],'schema':_0x344e1d,'bufferViews':_0x1784a4,'textures':_0x3d291c}),_0xa6213a[_0xc5fc40(0x17c)]=a526_0x1d5eeb['READY'],_0xa6213a['_promise'][_0xc5fc40(0x153)](_0xa6213a);})[_0xa44d36(0x158)](function(_0x28d34d){var _0x124ae5=_0xa44d36;if(_0xa6213a[_0x124ae5(0x155)]())return;_0xa6213a[_0x124ae5(0x15c)](),_0xa6213a[_0x124ae5(0x17c)]=a526_0x1d5eeb[_0x124ae5(0x180)];var _0x11d0e4=_0x124ae5(0x184);_0xa6213a['_promise'][_0x124ae5(0x18b)](_0xa6213a[_0x124ae5(0x196)](_0x11d0e4,_0x28d34d));});};function gatherBufferViewIdsFromProperties(_0x326c8f,_0x252b8a){var _0x1ecfbe=a526_0x5164e0;for(var _0x1044f4 in _0x326c8f){if(_0x326c8f[_0x1ecfbe(0x182)](_0x1044f4)){var _0x1643bf=_0x326c8f[_0x1044f4],_0x5b9947=_0x1643bf[_0x1ecfbe(0x175)],_0x567a37=_0x1643bf['arrayOffsetBufferView'],_0x97ffe6=_0x1643bf[_0x1ecfbe(0x15e)];a526_0x5f0c3d(_0x5b9947)&&(_0x252b8a[_0x5b9947]=!![]),a526_0x5f0c3d(_0x567a37)&&(_0x252b8a[_0x567a37]=!![]),a526_0x5f0c3d(_0x97ffe6)&&(_0x252b8a[_0x97ffe6]=!![]);}}}function gatherUsedBufferViewIds(_0x4a877c){var _0x375fb8=a526_0x5164e0,_0x466b08=_0x4a877c[_0x375fb8(0x172)],_0x5e70f5={};if(a526_0x5f0c3d(_0x466b08))for(var _0x267ff1=0x0;_0x267ff1<_0x466b08['length'];_0x267ff1++){var _0x1df628=_0x466b08[_0x267ff1];gatherBufferViewIdsFromProperties(_0x1df628[_0x375fb8(0x17d)],_0x5e70f5);}return _0x5e70f5;}function gatherUsedBufferViewIdsLegacy(_0x228d7b){var _0x308d40=a526_0x5164e0,_0xbdb5b4=_0x228d7b[_0x308d40(0x154)],_0x1d0e30={};if(a526_0x5f0c3d(_0xbdb5b4))for(var _0x1fe992 in _0xbdb5b4){if(_0xbdb5b4[_0x308d40(0x182)](_0x1fe992)){var _0x41704a=_0xbdb5b4[_0x1fe992],_0x55b718=_0x41704a[_0x308d40(0x17d)];a526_0x5f0c3d(_0x55b718)&&gatherBufferViewIdsFromProperties(_0x55b718,_0x1d0e30);}}return _0x1d0e30;}function loadBufferViews(_0x5e0b08){var _0x51c94c=a526_0x5164e0,_0x24e527;a526_0x5f0c3d(_0x5e0b08['_extension'])?_0x24e527=gatherUsedBufferViewIds(_0x5e0b08[_0x51c94c(0x167)]):_0x24e527=gatherUsedBufferViewIdsLegacy(_0x5e0b08['_extensionLegacy']);var _0x4a8ac1=[],_0x285dc1={};for(var _0x484daa in _0x24e527){if(_0x24e527[_0x51c94c(0x182)](_0x484daa)){var _0x1588da=a526_0x1f7bab[_0x51c94c(0x176)]({'gltf':_0x5e0b08[_0x51c94c(0x162)],'bufferViewId':parseInt(_0x484daa),'gltfResource':_0x5e0b08[_0x51c94c(0x190)],'baseResource':_0x5e0b08[_0x51c94c(0x152)]});_0x4a8ac1[_0x51c94c(0x15b)](_0x1588da[_0x51c94c(0x16d)]),_0x5e0b08['_bufferViewLoaders']['push'](_0x1588da),_0x285dc1[_0x484daa]=_0x1588da;}}return a526_0x1789fc['all'](_0x4a8ac1)[_0x51c94c(0x19b)](function(){var _0x3b6881=_0x51c94c,_0x7a1754={};for(var _0x5b565f in _0x285dc1){if(_0x285dc1[_0x3b6881(0x182)](_0x5b565f)){var _0x4e36a4=_0x285dc1[_0x5b565f],_0x2600e8=new Uint8Array(_0x4e36a4['typedArray']);_0x7a1754[_0x5b565f]=_0x2600e8;}}return unloadBufferViews(_0x5e0b08),_0x7a1754;});}function a526_0x452d(){var _0x2309c5=['loadTexture','length','FAILED','1932iNGGaF','hasOwnProperty','all','Failed\x20to\x20load\x20feature\x20metadata','propertyTextures','gltf','One\x20of\x20options.extension\x20or\x20options.extensionLegacy\x20must\x20be\x20specified','270USntCw','schema','options.gltf','reject','LOADING','extension','featureTextures','156661LqvjKE','_gltfResource','object','cacheKey','1173268kzWGAN','10dcZHJh','options.gltfResource','getError','_textureLoaders','prototype','5206176ukwRte','load','then','UNLOADED','12wwBWMP','_promise','_baseResource','resolve','featureTables','isDestroyed','texture','typeOf','otherwise','_cacheKey','extensionLegacy','push','unload','asynchronous','stringOffsetBufferView','_schemaLoader','process','15154940qHfOZH','_gltf','create','_featureMetadata','EMPTY_OBJECT','baseResource','_extension','9BkKEhc','options.baseResource','index','schemaUri','defineProperties','promise','_bufferViewLoaders','defer','_supportedImageFormats','_extensionLegacy','propertyTables','getDerivedResource','2710860ENqUUt','bufferView','loadBufferView','9550480nRydRR','132HyJjkt','loadSchema','frameState','supportedImageFormats','_state','properties'];a526_0x452d=function(){return _0x2309c5;};return a526_0x452d();}function gatherUsedTextureIds(_0x29cdf8){var _0x340d83=a526_0x5164e0,_0x1a4218={},_0x3719a8=_0x29cdf8[_0x340d83(0x185)];if(a526_0x5f0c3d(_0x3719a8))for(var _0x5deda7=0x0;_0x5deda7<_0x3719a8[_0x340d83(0x17f)];_0x5deda7++){var _0x526a04=_0x3719a8[_0x5deda7];a526_0x5f0c3d(_0x526a04[_0x340d83(0x17d)])&&(_0x1a4218[_0x526a04[_0x340d83(0x16a)]]=_0x526a04);}return _0x1a4218;}function gatherTextureIdsFromProperties(_0x184e93,_0x3f9ca0){var _0x58232e=a526_0x5164e0;for(var _0x2b227b in _0x184e93){if(_0x184e93[_0x58232e(0x182)](_0x2b227b)){var _0x43b3ac=_0x184e93[_0x2b227b],_0x2252a7=_0x43b3ac[_0x58232e(0x156)];_0x3f9ca0[_0x2252a7['index']]=_0x2252a7;}}}function gatherUsedTextureIdsLegacy(_0x24c08d){var _0x48fdbb=a526_0x5164e0,_0x1d0e03={},_0x3990ce=_0x24c08d[_0x48fdbb(0x18e)];if(a526_0x5f0c3d(_0x3990ce))for(var _0xde95d5 in _0x3990ce){if(_0x3990ce[_0x48fdbb(0x182)](_0xde95d5)){var _0x3848a8=_0x3990ce[_0xde95d5],_0x5f4d96=_0x3848a8[_0x48fdbb(0x17d)];a526_0x5f0c3d(_0x5f4d96)&&gatherTextureIdsFromProperties(_0x5f4d96,_0x1d0e03);}}return _0x1d0e03;}function loadTextures(_0x11d41e){var _0x485fc2=a526_0x5164e0,_0x2094e1;a526_0x5f0c3d(_0x11d41e['_extension'])?_0x2094e1=gatherUsedTextureIds(_0x11d41e[_0x485fc2(0x167)]):_0x2094e1=gatherUsedTextureIdsLegacy(_0x11d41e['_extensionLegacy']);var _0x5d44e6=_0x11d41e[_0x485fc2(0x162)],_0x50dbe7=_0x11d41e[_0x485fc2(0x190)],_0x65e801=_0x11d41e[_0x485fc2(0x152)],_0x201bba=_0x11d41e[_0x485fc2(0x170)],_0x2fcca4=_0x11d41e['_asynchronous'],_0x137619=[],_0x4c9a3c={};for(var _0x2f4ab0 in _0x2094e1){if(_0x2094e1[_0x485fc2(0x182)](_0x2f4ab0)){var _0x257b42=a526_0x1f7bab[_0x485fc2(0x17e)]({'gltf':_0x5d44e6,'textureInfo':_0x2094e1[_0x2f4ab0],'gltfResource':_0x50dbe7,'baseResource':_0x65e801,'supportedImageFormats':_0x201bba,'asynchronous':_0x2fcca4});_0x137619[_0x485fc2(0x15b)](_0x257b42[_0x485fc2(0x16d)]),_0x11d41e[_0x485fc2(0x197)][_0x485fc2(0x15b)](_0x257b42),_0x4c9a3c[_0x2f4ab0]=_0x257b42;}}return a526_0x1789fc[_0x485fc2(0x183)](_0x137619)[_0x485fc2(0x19b)](function(){var _0x57d7e3=_0x485fc2,_0x1fa5c0={};for(var _0x21c9c9 in _0x4c9a3c){if(_0x4c9a3c[_0x57d7e3(0x182)](_0x21c9c9)){var _0x402bb0=_0x4c9a3c[_0x21c9c9];_0x1fa5c0[_0x21c9c9]=_0x402bb0['texture'];}}return _0x1fa5c0;});}function a526_0x4f2c(_0xe1b00a,_0x5cb387){var _0x452de7=a526_0x452d();return a526_0x4f2c=function(_0x4f2cde,_0x3f0166){_0x4f2cde=_0x4f2cde-0x152;var _0x592913=_0x452de7[_0x4f2cde];return _0x592913;},a526_0x4f2c(_0xe1b00a,_0x5cb387);}function loadSchema(_0xc1814){var _0x11738b=a526_0x5164e0,_0x26d734=a526_0x906e0e(_0xc1814[_0x11738b(0x167)],_0xc1814[_0x11738b(0x171)]),_0x27c282;if(a526_0x5f0c3d(_0x26d734[_0x11738b(0x16b)])){var _0x2ecc34=_0xc1814[_0x11738b(0x152)][_0x11738b(0x173)]({'url':_0x26d734[_0x11738b(0x16b)]});_0x27c282=a526_0x1f7bab[_0x11738b(0x179)]({'resource':_0x2ecc34});}else _0x27c282=a526_0x1f7bab[_0x11738b(0x179)]({'schema':_0x26d734[_0x11738b(0x189)]});return _0xc1814[_0x11738b(0x15f)]=_0x27c282,_0x27c282[_0x11738b(0x16d)][_0x11738b(0x19b)](function(_0x10c7eb){var _0x22dc1e=_0x11738b;return _0x10c7eb[_0x22dc1e(0x189)];});}GltfFeatureMetadataLoader[a526_0x5164e0(0x198)]['process']=function(_0x361471){var _0x1be916=a526_0x5164e0;a526_0x21f92f[_0x1be916(0x157)][_0x1be916(0x191)](_0x1be916(0x17a),_0x361471);if(this['_state']!==a526_0x1d5eeb[_0x1be916(0x18c)])return;var _0x4e50cf=this[_0x1be916(0x197)],_0x4db2c2=_0x4e50cf[_0x1be916(0x17f)];for(var _0x41418f=0x0;_0x41418f<_0x4db2c2;++_0x41418f){var _0x476655=_0x4e50cf[_0x41418f];_0x476655[_0x1be916(0x160)](_0x361471);}};function unloadBufferViews(_0x30e447){var _0x1bb46b=a526_0x5164e0,_0x35c98e=_0x30e447[_0x1bb46b(0x16e)],_0x331302=_0x35c98e[_0x1bb46b(0x17f)];for(var _0xe2650c=0x0;_0xe2650c<_0x331302;++_0xe2650c){a526_0x1f7bab[_0x1bb46b(0x15c)](_0x35c98e[_0xe2650c]);}_0x30e447['_bufferViewLoaders'][_0x1bb46b(0x17f)]=0x0;}function unloadTextures(_0x3b3ec1){var _0x1112d5=a526_0x5164e0,_0x1c687b=_0x3b3ec1[_0x1112d5(0x197)],_0x2b2948=_0x1c687b[_0x1112d5(0x17f)];for(var _0x4a8f6d=0x0;_0x4a8f6d<_0x2b2948;++_0x4a8f6d){a526_0x1f7bab[_0x1112d5(0x15c)](_0x1c687b[_0x4a8f6d]);}_0x3b3ec1['_textureLoaders'][_0x1112d5(0x17f)]=0x0;}GltfFeatureMetadataLoader[a526_0x5164e0(0x198)]['unload']=function(){var _0x440a80=a526_0x5164e0;unloadBufferViews(this),unloadTextures(this),a526_0x5f0c3d(this[_0x440a80(0x15f)])&&a526_0x1f7bab[_0x440a80(0x15c)](this[_0x440a80(0x15f)]),this[_0x440a80(0x15f)]=undefined,this[_0x440a80(0x164)]=undefined;};