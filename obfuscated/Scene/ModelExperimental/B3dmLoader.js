var a617_0x29679f=a617_0x4c75;(function(_0x1fd807,_0x2ad749){var _0x3433a0=a617_0x4c75,_0x43ea15=_0x1fd807();while(!![]){try{var _0x200af6=parseInt(_0x3433a0(0x188))/0x1+parseInt(_0x3433a0(0x15b))/0x2+parseInt(_0x3433a0(0x186))/0x3*(-parseInt(_0x3433a0(0x15e))/0x4)+-parseInt(_0x3433a0(0x177))/0x5*(parseInt(_0x3433a0(0x15d))/0x6)+parseInt(_0x3433a0(0x163))/0x7*(-parseInt(_0x3433a0(0x16f))/0x8)+-parseInt(_0x3433a0(0x161))/0x9*(parseInt(_0x3433a0(0x156))/0xa)+parseInt(_0x3433a0(0x18f))/0xb;if(_0x200af6===_0x2ad749)break;else _0x43ea15['push'](_0x43ea15['shift']());}catch(_0x59cb66){_0x43ea15['push'](_0x43ea15['shift']());}}}(a617_0x16fe,0xdcdf9));import a617_0x2022db from'../Axis.js';import a617_0x51e02b from'../B3dmParser.js';import a617_0x2ee193 from'../../Core/Cartesian3.js';import a617_0x8ded5f from'../Cesium3DTileFeatureTable.js';import a617_0x2e5bb7 from'../../Core/Check.js';import a617_0xc45905 from'../../Core/ComponentDatatype.js';import a617_0x33ec02 from'../../Core/defaultValue.js';import a617_0xfa9524 from'../../Core/defined.js';function a617_0x4c75(_0x371121,_0x576da7){var _0x16feff=a617_0x16fe();return a617_0x4c75=function(_0x4c7501,_0x4f2a97){_0x4c7501=_0x4c7501-0x139;var _0xf3e5a4=_0x16feff[_0x4c7501];return _0xf3e5a4;},a617_0x4c75(_0x371121,_0x576da7);}import a617_0x2f8f07 from'../FeatureMetadata.js';import a617_0x304916 from'../GltfLoader.js';import a617_0x3e05b2 from'../../Core/Matrix4.js';import a617_0x19181b from'../MetadataClass.js';import a617_0x26dd5a from'../ModelComponents.js';import a617_0x1720a0 from'./ModelExperimentalUtility.js';import a617_0x24aac9 from'../parseBatchTable.js';import a617_0x5e3ff1 from'../PropertyTable.js';import a617_0x86eb9e from'../ResourceLoader.js';import a617_0x4d44ba from'../../ThirdParty/when.js';import a617_0x28b39e from'../VertexAttributeSemantic.js';var B3dmLoaderState={'UNLOADED':0x0,'LOADING':0x1,'PROCESSING':0x2,'READY':0x3,'FAILED':0x4},FeatureIdAttribute=a617_0x26dd5a[a617_0x29679f(0x180)];function B3dmLoader(_0x19db3f){var _0x396514=a617_0x29679f;_0x19db3f=a617_0x33ec02(_0x19db3f,a617_0x33ec02[_0x396514(0x17e)]);var _0x1a65fb=_0x19db3f[_0x396514(0x17f)],_0x58f470=_0x19db3f[_0x396514(0x168)],_0x4e960b=_0x19db3f[_0x396514(0x17c)],_0x22709a=a617_0x33ec02(_0x19db3f[_0x396514(0x189)],0x0),_0xa69d0b=a617_0x33ec02(_0x19db3f[_0x396514(0x147)],![]),_0x218dbf=a617_0x33ec02(_0x19db3f[_0x396514(0x13a)],!![]),_0x50df=a617_0x33ec02(_0x19db3f[_0x396514(0x151)],!![]),_0x4dda72=a617_0x33ec02(_0x19db3f[_0x396514(0x145)],a617_0x2022db['Y']),_0x370744=a617_0x33ec02(_0x19db3f[_0x396514(0x157)],a617_0x2022db['X']),_0x4f28d1=a617_0x33ec02(_0x19db3f[_0x396514(0x16d)],![]);a617_0x2e5bb7[_0x396514(0x18a)]['object'](_0x396514(0x17b),_0x1a65fb),a617_0x2e5bb7[_0x396514(0x18a)][_0x396514(0x154)](_0x396514(0x14e),_0x4e960b),_0x58f470=a617_0xfa9524(_0x58f470)?_0x58f470:_0x1a65fb[_0x396514(0x13d)](),this[_0x396514(0x18b)]=_0x1a65fb,this[_0x396514(0x182)]=_0x58f470,this[_0x396514(0x150)]=_0x4e960b,this[_0x396514(0x15c)]=_0x22709a,this['_releaseGltfJson']=_0xa69d0b,this['_asynchronous']=_0x218dbf,this['_incrementallyLoadTextures']=_0x50df,this[_0x396514(0x14f)]=_0x4dda72,this[_0x396514(0x152)]=_0x370744,this[_0x396514(0x16e)]=_0x4f28d1,this[_0x396514(0x13f)]=B3dmLoaderState['UNLOADED'],this[_0x396514(0x172)]=a617_0x4d44ba[_0x396514(0x176)](),this['_gltfLoader']=undefined,this['_batchLength']=0x0,this[_0x396514(0x16a)]=undefined,this[_0x396514(0x15f)]=undefined,this[_0x396514(0x167)]=undefined,this[_0x396514(0x171)]=a617_0x3e05b2['IDENTITY'];}a617_0xfa9524(Object[a617_0x29679f(0x175)])&&(B3dmLoader[a617_0x29679f(0x14c)]=Object[a617_0x29679f(0x175)](a617_0x86eb9e[a617_0x29679f(0x14c)]),B3dmLoader[a617_0x29679f(0x14c)][a617_0x29679f(0x170)]=B3dmLoader);Object[a617_0x29679f(0x146)](B3dmLoader['prototype'],{'promise':{'get':function(){var _0x68f50=a617_0x29679f;return this[_0x68f50(0x172)][_0x68f50(0x174)];}},'texturesLoadedPromise':{'get':function(){return this['_gltfLoader']['texturesLoadedPromise'];}},'cacheKey':{'get':function(){return undefined;}},'components':{'get':function(){var _0x305a70=a617_0x29679f;return this[_0x305a70(0x167)];}},'transform':{'get':function(){var _0x90746b=a617_0x29679f;return this[_0x90746b(0x171)];}}}),B3dmLoader[a617_0x29679f(0x14c)][a617_0x29679f(0x179)]=function(){var _0x3e5950=a617_0x29679f,_0x5da347=a617_0x51e02b[_0x3e5950(0x187)](this[_0x3e5950(0x150)],this['_byteOffset']),_0x3a9267=_0x5da347[_0x3e5950(0x16b)],_0x3c7909=_0x5da347['featureTableJson'],_0x57bc19=_0x5da347[_0x3e5950(0x13c)],_0x580209=_0x5da347[_0x3e5950(0x16c)],_0x4b3cbc=_0x5da347[_0x3e5950(0x139)],_0x33947e=new a617_0x8ded5f(_0x3c7909,_0x57bc19);_0x3a9267=_0x33947e[_0x3e5950(0x13b)]('BATCH_LENGTH'),this[_0x3e5950(0x140)]=_0x3a9267;var _0x1bdd76=_0x33947e[_0x3e5950(0x13b)](_0x3e5950(0x185),a617_0xc45905[_0x3e5950(0x158)],0x3);a617_0xfa9524(_0x1bdd76)&&(this[_0x3e5950(0x171)]=a617_0x3e05b2[_0x3e5950(0x17a)](a617_0x2ee193[_0x3e5950(0x155)](_0x1bdd76)));this[_0x3e5950(0x15f)]={'json':_0x580209,'binary':_0x4b3cbc};var _0x912a78=new a617_0x304916({'upAxis':this[_0x3e5950(0x14f)],'typedArray':_0x5da347[_0x3e5950(0x169)],'forwardAxis':this[_0x3e5950(0x152)],'gltfResource':this[_0x3e5950(0x18b)],'baseResource':this[_0x3e5950(0x182)],'releaseGltfJson':this[_0x3e5950(0x148)],'incrementallyLoadTextures':this[_0x3e5950(0x149)],'loadAsTypedArray':this['_loadAsTypedArray']});this[_0x3e5950(0x184)]=_0x912a78,this[_0x3e5950(0x13f)]=B3dmLoaderState[_0x3e5950(0x181)];var _0x31d571=this;_0x912a78['load'](),_0x912a78[_0x3e5950(0x174)][_0x3e5950(0x17d)](function(){var _0x1f7d7c=_0x3e5950;if(_0x31d571[_0x1f7d7c(0x153)]())return;var _0x2cc572=_0x912a78[_0x1f7d7c(0x164)];createFeatureMetadata(_0x31d571,_0x2cc572),_0x31d571[_0x1f7d7c(0x167)]=_0x2cc572,_0x31d571[_0x1f7d7c(0x13f)]=B3dmLoaderState[_0x1f7d7c(0x18e)],_0x31d571['_promise'][_0x1f7d7c(0x178)](_0x31d571);})['otherwise'](function(_0x3f0f22){var _0x29ce39=_0x3e5950;if(_0x31d571[_0x29ce39(0x153)]())return;handleError(_0x31d571,_0x3f0f22);});};function handleError(_0x4f36c6,_0x3719e2){var _0x414bcd=a617_0x29679f;_0x4f36c6[_0x414bcd(0x15a)](),_0x4f36c6[_0x414bcd(0x13f)]=B3dmLoaderState[_0x414bcd(0x14a)];var _0x573955='Failed\x20to\x20load\x20B3DM';_0x3719e2=_0x4f36c6['getError'](_0x573955,_0x3719e2),_0x4f36c6[_0x414bcd(0x172)][_0x414bcd(0x159)](_0x3719e2);}B3dmLoader[a617_0x29679f(0x14c)][a617_0x29679f(0x144)]=function(_0x2733ce){var _0x465d71=a617_0x29679f;a617_0x2e5bb7[_0x465d71(0x18a)]['object'](_0x465d71(0x166),_0x2733ce),this[_0x465d71(0x13f)]===B3dmLoaderState[_0x465d71(0x181)]&&(this[_0x465d71(0x13f)]=B3dmLoaderState[_0x465d71(0x165)]),this['_state']===B3dmLoaderState['PROCESSING']&&this[_0x465d71(0x184)][_0x465d71(0x144)](_0x2733ce);};function createFeatureMetadata(_0xe869a8,_0x1e0ca2){var _0x1d96eb=a617_0x29679f,_0x395045=_0xe869a8[_0x1d96eb(0x15f)],_0x542f37=_0xe869a8[_0x1d96eb(0x140)];if(_0x542f37===0x0)return;var _0x57a88a;if(a617_0xfa9524(_0x395045['json']))_0x57a88a=a617_0x24aac9({'count':_0x542f37,'batchTable':_0x395045[_0x1d96eb(0x142)],'binaryBody':_0x395045[_0x1d96eb(0x18d)]});else{var _0x478e85=new a617_0x5e3ff1({'name':a617_0x19181b['BATCH_TABLE_CLASS_NAME'],'count':_0x542f37});_0x57a88a=new a617_0x2f8f07({'schema':{},'propertyTables':[_0x478e85]});}var _0x32a5d6=_0x1e0ca2[_0x1d96eb(0x18c)][_0x1d96eb(0x162)];for(var _0x58a4c2=0x0;_0x58a4c2<_0x32a5d6[_0x1d96eb(0x183)];_0x58a4c2++){processNode(_0x32a5d6[_0x58a4c2]);}_0x1e0ca2['featureMetadata']=_0x57a88a;}function processNode(_0x3e459f){var _0x17a707=a617_0x29679f;if(!a617_0xfa9524(_0x3e459f[_0x17a707(0x141)])&&!a617_0xfa9524(_0x3e459f[_0x17a707(0x13e)]))return;var _0x26f6f3;if(a617_0xfa9524(_0x3e459f['children']))for(_0x26f6f3=0x0;_0x26f6f3<_0x3e459f[_0x17a707(0x141)][_0x17a707(0x183)];_0x26f6f3++){processNode(_0x3e459f['children'][_0x26f6f3]);}if(a617_0xfa9524(_0x3e459f[_0x17a707(0x13e)]))for(_0x26f6f3=0x0;_0x26f6f3<_0x3e459f[_0x17a707(0x13e)][_0x17a707(0x183)];_0x26f6f3++){var _0xd2f187=_0x3e459f[_0x17a707(0x13e)][_0x26f6f3],_0x160dfb=a617_0x1720a0[_0x17a707(0x14d)](_0xd2f187,a617_0x28b39e[_0x17a707(0x143)]);if(a617_0xfa9524(_0x160dfb)){_0x160dfb[_0x17a707(0x173)]=0x0;var _0x367a50=new FeatureIdAttribute();_0x367a50[_0x17a707(0x160)]=0x0,_0x367a50[_0x17a707(0x173)]=0x0,_0xd2f187[_0x17a707(0x14b)]['push'](_0x367a50);}}}function a617_0x16fe(){var _0x293ab3=['featureTableBinary','clone','primitives','_state','_batchLength','children','json','FEATURE_ID','process','upAxis','defineProperties','releaseGltfJson','_releaseGltfJson','_incrementallyLoadTextures','FAILED','featureIdAttributes','prototype','getAttributeBySemantic','options.arrayBuffer','_upAxis','_arrayBuffer','incrementallyLoadTextures','_forwardAxis','isDestroyed','object','fromArray','2932690ILgpvO','forwardAxis','FLOAT','reject','unload','442386XdgRfh','_byteOffset','8965830xKSPFA','4ATGZzZ','_batchTable','propertyTableId','18LwyKrW','nodes','231ebswSg','components','PROCESSING','frameState','_components','baseResource','gltf','_propertyTable','batchLength','batchTableJson','loadAsTypedArray','_loadAsTypedArray','243128ssgQOV','constructor','_transform','_promise','setIndex','promise','create','defer','5sSvCSh','resolve','load','fromTranslation','options.b3dmResource','arrayBuffer','then','EMPTY_OBJECT','b3dmResource','FeatureIdAttribute','LOADING','_baseResource','length','_gltfLoader','RTC_CENTER','3762111HSJDWT','parse','68691KCIrnV','byteOffset','typeOf','_b3dmResource','scene','binary','READY','54478556fbNDEV','batchTableBinary','asynchronous','getGlobalProperty'];a617_0x16fe=function(){return _0x293ab3;};return a617_0x16fe();}B3dmLoader[a617_0x29679f(0x14c)]['unload']=function(){var _0x2a06ee=a617_0x29679f;a617_0xfa9524(this[_0x2a06ee(0x184)])&&this[_0x2a06ee(0x184)][_0x2a06ee(0x15a)](),this[_0x2a06ee(0x167)]=undefined;};export default B3dmLoader;