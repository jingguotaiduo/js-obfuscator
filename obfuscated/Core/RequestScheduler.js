var a215_0x413980=a215_0x506b;(function(_0x1aff4f,_0x30400b){var _0x2b9276=a215_0x506b,_0x2578fd=_0x1aff4f();while(!![]){try{var _0xbd55fa=-parseInt(_0x2b9276(0x12c))/0x1*(-parseInt(_0x2b9276(0x13a))/0x2)+parseInt(_0x2b9276(0xfe))/0x3*(parseInt(_0x2b9276(0xfd))/0x4)+parseInt(_0x2b9276(0x11f))/0x5*(parseInt(_0x2b9276(0xfc))/0x6)+-parseInt(_0x2b9276(0x103))/0x7*(-parseInt(_0x2b9276(0x120))/0x8)+parseInt(_0x2b9276(0xf9))/0x9*(-parseInt(_0x2b9276(0xfa))/0xa)+-parseInt(_0x2b9276(0x11e))/0xb*(-parseInt(_0x2b9276(0x125))/0xc)+-parseInt(_0x2b9276(0xf7))/0xd;if(_0xbd55fa===_0x30400b)break;else _0x2578fd['push'](_0x2578fd['shift']());}catch(_0xb6fd29){_0x2578fd['push'](_0x2578fd['shift']());}}}(a215_0x1246,0x9b8c6));import a215_0x5ba63e from'../ThirdParty/Uri.js';import a215_0x336a06 from'../ThirdParty/when.js';import a215_0x1a1e75 from'./Check.js';import a215_0x1fe22c from'./defaultValue.js';import a215_0x4eda0e from'./defined.js';import a215_0xa79f6e from'./Event.js';import a215_0x56b7f9 from'./Heap.js';import a215_0x2303e2 from'./isBlobUri.js';import a215_0x5cf0d2 from'./isDataUri.js';import a215_0x13dd9b from'./RequestState.js';function a215_0x506b(_0x34d1b6,_0x1e1a4f){var _0x1246a3=a215_0x1246();return a215_0x506b=function(_0x506b08,_0x4809c0){_0x506b08=_0x506b08-0xf4;var _0x292360=_0x1246a3[_0x506b08];return _0x292360;},a215_0x506b(_0x34d1b6,_0x1e1a4f);}function sortRequests(_0x45e83d,_0xafa641){var _0x183f93=a215_0x506b;return _0x45e83d[_0x183f93(0xf6)]-_0xafa641[_0x183f93(0xf6)];}var statistics={'numberOfAttemptedRequests':0x0,'numberOfActiveRequests':0x0,'numberOfCancelledRequests':0x0,'numberOfCancelledActiveRequests':0x0,'numberOfFailedRequests':0x0,'numberOfActiveRequestsEver':0x0,'lastNumberOfActiveRequests':0x0},priorityHeapLength=0x14,requestHeap=new a215_0x56b7f9({'comparator':sortRequests});requestHeap[a215_0x413980(0x138)]=priorityHeapLength,requestHeap['reserve'](priorityHeapLength);var activeRequests=[],numberOfActiveRequestsByServer={},pageUri=typeof document!=='undefined'?new a215_0x5ba63e(document[a215_0x413980(0x139)][a215_0x413980(0x105)]):new a215_0x5ba63e(),requestCompletedEvent=new a215_0xa79f6e();function RequestScheduler(){}RequestScheduler[a215_0x413980(0x127)]=0x32,RequestScheduler[a215_0x413980(0xfb)]=0x6,RequestScheduler['requestsByServer']={'api.cesium.com:443':0x12,'assets.cesium.com:443':0x12},RequestScheduler[a215_0x413980(0x12e)]=!![],RequestScheduler[a215_0x413980(0x102)]=![],RequestScheduler[a215_0x413980(0x126)]=requestCompletedEvent,Object[a215_0x413980(0x113)](RequestScheduler,{'statistics':{'get':function(){return statistics;}},'priorityHeapLength':{'get':function(){return priorityHeapLength;},'set':function(_0x5ae2da){var _0x45b767=a215_0x413980;if(_0x5ae2da<priorityHeapLength)while(requestHeap['length']>_0x5ae2da){var _0x166995=requestHeap['pop']();cancelRequest(_0x166995);}priorityHeapLength=_0x5ae2da,requestHeap[_0x45b767(0x138)]=_0x5ae2da,requestHeap[_0x45b767(0x109)](_0x5ae2da);}}});function updatePriority(_0x22ea71){var _0x1e70d0=a215_0x413980;a215_0x4eda0e(_0x22ea71[_0x1e70d0(0x135)])&&(_0x22ea71[_0x1e70d0(0xf6)]=_0x22ea71[_0x1e70d0(0x135)]());}RequestScheduler[a215_0x413980(0x11b)]=function(_0x512581,_0x4e9679){var _0x28dde1=a215_0x413980;_0x4e9679=a215_0x1fe22c(_0x4e9679,0x1);var _0xecc321=a215_0x1fe22c(RequestScheduler['requestsByServer'][_0x512581],RequestScheduler[_0x28dde1(0xfb)]),_0x96a2cf=numberOfActiveRequestsByServer[_0x512581]+_0x4e9679<=_0xecc321;return _0x96a2cf;},RequestScheduler['heapHasOpenSlots']=function(_0x83a45b){var _0x518634=a215_0x413980,_0x4a0df8=requestHeap[_0x518634(0x101)]+_0x83a45b<=priorityHeapLength;return _0x4a0df8;};function issueRequest(_0x2ee3b1){var _0x55f7e5=a215_0x413980;return _0x2ee3b1['state']===a215_0x13dd9b[_0x55f7e5(0x136)]&&(_0x2ee3b1[_0x55f7e5(0x132)]=a215_0x13dd9b['ISSUED'],_0x2ee3b1['deferred']=a215_0x336a06[_0x55f7e5(0xff)]()),_0x2ee3b1[_0x55f7e5(0x129)][_0x55f7e5(0x11c)];}function getRequestReceivedFunction(_0x2aab14){return function(_0x4fd533){var _0x18f5a7=a215_0x506b;if(_0x2aab14[_0x18f5a7(0x132)]===a215_0x13dd9b[_0x18f5a7(0x108)])return;var _0x1f262f=_0x2aab14['deferred'];--statistics[_0x18f5a7(0x104)],--numberOfActiveRequestsByServer[_0x2aab14[_0x18f5a7(0x12a)]],requestCompletedEvent[_0x18f5a7(0x123)](),_0x2aab14[_0x18f5a7(0x132)]=a215_0x13dd9b[_0x18f5a7(0x134)],_0x2aab14[_0x18f5a7(0x129)]=undefined,_0x1f262f[_0x18f5a7(0x10f)](_0x4fd533);};}function getRequestFailedFunction(_0x11911e){return function(_0x4553de){var _0x4ade05=a215_0x506b;if(_0x11911e[_0x4ade05(0x132)]===a215_0x13dd9b['CANCELLED'])return;++statistics['numberOfFailedRequests'],--statistics[_0x4ade05(0x104)],--numberOfActiveRequestsByServer[_0x11911e[_0x4ade05(0x12a)]],requestCompletedEvent[_0x4ade05(0x123)](_0x4553de),_0x11911e[_0x4ade05(0x132)]=a215_0x13dd9b[_0x4ade05(0x10c)],_0x11911e[_0x4ade05(0x129)][_0x4ade05(0x111)](_0x4553de);};}function startRequest(_0x439b25){var _0x91d4d3=a215_0x413980,_0x331a49=issueRequest(_0x439b25);return _0x439b25[_0x91d4d3(0x132)]=a215_0x13dd9b[_0x91d4d3(0x10a)],activeRequests[_0x91d4d3(0x10d)](_0x439b25),++statistics['numberOfActiveRequests'],++statistics['numberOfActiveRequestsEver'],++numberOfActiveRequestsByServer[_0x439b25[_0x91d4d3(0x12a)]],_0x439b25['requestFunction']()[_0x91d4d3(0x115)](getRequestReceivedFunction(_0x439b25))['otherwise'](getRequestFailedFunction(_0x439b25)),_0x331a49;}function cancelRequest(_0x31c01d){var _0x3a7fd=a215_0x413980,_0xa206c6=_0x31c01d[_0x3a7fd(0x132)]===a215_0x13dd9b[_0x3a7fd(0x10a)];_0x31c01d[_0x3a7fd(0x132)]=a215_0x13dd9b[_0x3a7fd(0x108)],++statistics[_0x3a7fd(0xf4)];if(a215_0x4eda0e(_0x31c01d[_0x3a7fd(0x129)])){var _0x1bdd85=_0x31c01d[_0x3a7fd(0x129)];_0x31c01d[_0x3a7fd(0x129)]=undefined,_0x1bdd85['reject']();}_0xa206c6&&(--statistics['numberOfActiveRequests'],--numberOfActiveRequestsByServer[_0x31c01d['serverKey']],++statistics[_0x3a7fd(0x10b)]),a215_0x4eda0e(_0x31c01d[_0x3a7fd(0x124)])&&_0x31c01d[_0x3a7fd(0x124)]();}RequestScheduler[a215_0x413980(0x137)]=function(){var _0x34f331=a215_0x413980,_0x25aac5,_0x319b37,_0x408d63=0x0,_0x3123db=activeRequests['length'];for(_0x25aac5=0x0;_0x25aac5<_0x3123db;++_0x25aac5){_0x319b37=activeRequests[_0x25aac5];_0x319b37[_0x34f331(0x116)]&&cancelRequest(_0x319b37);if(_0x319b37['state']!==a215_0x13dd9b['ACTIVE']){++_0x408d63;continue;}_0x408d63>0x0&&(activeRequests[_0x25aac5-_0x408d63]=_0x319b37);}activeRequests[_0x34f331(0x101)]-=_0x408d63;var _0x1477d8=requestHeap['internalArray'],_0x52d8fa=requestHeap[_0x34f331(0x101)];for(_0x25aac5=0x0;_0x25aac5<_0x52d8fa;++_0x25aac5){updatePriority(_0x1477d8[_0x25aac5]);}requestHeap['resort']();var _0x34340b=Math['max'](RequestScheduler[_0x34f331(0x127)]-activeRequests[_0x34f331(0x101)],0x0),_0x1b9a48=0x0;while(_0x1b9a48<_0x34340b&&requestHeap[_0x34f331(0x101)]>0x0){_0x319b37=requestHeap[_0x34f331(0x130)]();if(_0x319b37[_0x34f331(0x116)]){cancelRequest(_0x319b37);continue;}if(_0x319b37['throttleByServer']&&!RequestScheduler[_0x34f331(0x11b)](_0x319b37[_0x34f331(0x12a)])){cancelRequest(_0x319b37);continue;}startRequest(_0x319b37),++_0x1b9a48;}updateStatistics();},RequestScheduler['getServerKey']=function(_0x403e32){var _0x1ccc15=a215_0x413980;a215_0x1a1e75[_0x1ccc15(0x106)]['string'](_0x1ccc15(0x10e),_0x403e32);var _0x150565=new a215_0x5ba63e(_0x403e32);_0x150565[_0x1ccc15(0x12b)]()===''&&(_0x150565=new a215_0x5ba63e(_0x403e32)['absoluteTo'](pageUri),_0x150565[_0x1ccc15(0x114)]());var _0x347e6e=_0x150565['authority']();!/:/[_0x1ccc15(0x133)](_0x347e6e)&&(_0x347e6e=_0x347e6e+':'+(_0x150565[_0x1ccc15(0x12b)]()===_0x1ccc15(0x11d)?_0x1ccc15(0x128):'80'));var _0x3edc32=numberOfActiveRequestsByServer[_0x347e6e];return!a215_0x4eda0e(_0x3edc32)&&(numberOfActiveRequestsByServer[_0x347e6e]=0x0),_0x347e6e;},RequestScheduler[a215_0x413980(0x112)]=function(_0x40d5af){var _0x1f2a78=a215_0x413980;a215_0x1a1e75[_0x1f2a78(0x106)]['object'](_0x1f2a78(0x112),_0x40d5af),a215_0x1a1e75['typeOf']['string'](_0x1f2a78(0xf8),_0x40d5af['url']),a215_0x1a1e75[_0x1f2a78(0x106)][_0x1f2a78(0x100)]('request.requestFunction',_0x40d5af[_0x1f2a78(0x110)]);if(a215_0x5cf0d2(_0x40d5af[_0x1f2a78(0x10e)])||a215_0x2303e2(_0x40d5af[_0x1f2a78(0x10e)]))return requestCompletedEvent[_0x1f2a78(0x123)](),_0x40d5af[_0x1f2a78(0x132)]=a215_0x13dd9b[_0x1f2a78(0x134)],_0x40d5af['requestFunction']();++statistics[_0x1f2a78(0x11a)];!a215_0x4eda0e(_0x40d5af[_0x1f2a78(0x12a)])&&(_0x40d5af[_0x1f2a78(0x12a)]=RequestScheduler[_0x1f2a78(0xf5)](_0x40d5af[_0x1f2a78(0x10e)]));if(RequestScheduler[_0x1f2a78(0x12e)]&&_0x40d5af[_0x1f2a78(0x122)]&&!RequestScheduler[_0x1f2a78(0x11b)](_0x40d5af[_0x1f2a78(0x12a)]))return undefined;if(!RequestScheduler['throttleRequests']||!_0x40d5af['throttle'])return startRequest(_0x40d5af);if(activeRequests['length']>=RequestScheduler[_0x1f2a78(0x127)])return undefined;updatePriority(_0x40d5af);var _0x4a4141=requestHeap['insert'](_0x40d5af);if(a215_0x4eda0e(_0x4a4141)){if(_0x4a4141===_0x40d5af)return undefined;cancelRequest(_0x4a4141);}return issueRequest(_0x40d5af);};function updateStatistics(){var _0x4a43c6=a215_0x413980;if(!RequestScheduler[_0x4a43c6(0x102)])return;statistics['numberOfActiveRequests']===0x0&&statistics[_0x4a43c6(0x117)]>0x0&&(statistics[_0x4a43c6(0x11a)]>0x0&&(console['log']('Number\x20of\x20attempted\x20requests:\x20'+statistics[_0x4a43c6(0x11a)]),statistics[_0x4a43c6(0x11a)]=0x0),statistics[_0x4a43c6(0xf4)]>0x0&&(console[_0x4a43c6(0x12f)](_0x4a43c6(0x107)+statistics[_0x4a43c6(0xf4)]),statistics[_0x4a43c6(0xf4)]=0x0),statistics[_0x4a43c6(0x10b)]>0x0&&(console[_0x4a43c6(0x12f)](_0x4a43c6(0x121)+statistics['numberOfCancelledActiveRequests']),statistics['numberOfCancelledActiveRequests']=0x0),statistics[_0x4a43c6(0x131)]>0x0&&(console[_0x4a43c6(0x12f)]('Number\x20of\x20failed\x20requests:\x20'+statistics[_0x4a43c6(0x131)]),statistics[_0x4a43c6(0x131)]=0x0)),statistics['lastNumberOfActiveRequests']=statistics[_0x4a43c6(0x104)];}RequestScheduler['clearForSpecs']=function(){var _0x3dbbb1=a215_0x413980;while(requestHeap[_0x3dbbb1(0x101)]>0x0){var _0x37b47f=requestHeap[_0x3dbbb1(0x130)]();cancelRequest(_0x37b47f);}var _0x4e327a=activeRequests['length'];for(var _0x719abb=0x0;_0x719abb<_0x4e327a;++_0x719abb){cancelRequest(activeRequests[_0x719abb]);}activeRequests[_0x3dbbb1(0x101)]=0x0,numberOfActiveRequestsByServer={},statistics[_0x3dbbb1(0x11a)]=0x0,statistics[_0x3dbbb1(0x104)]=0x0,statistics[_0x3dbbb1(0xf4)]=0x0,statistics['numberOfCancelledActiveRequests']=0x0,statistics[_0x3dbbb1(0x131)]=0x0,statistics[_0x3dbbb1(0x119)]=0x0,statistics[_0x3dbbb1(0x117)]=0x0;},RequestScheduler[a215_0x413980(0x12d)]=function(_0x3b1e75){return numberOfActiveRequestsByServer[_0x3b1e75];},RequestScheduler[a215_0x413980(0x118)]=requestHeap;function a215_0x1246(){var _0x18154a=['1563820ogWRbP','maximumRequestsPerServer','2663526LDvXEu','87800aeMoKS','111LRTXrg','defer','func','length','debugShowStatistics','219359LbGuSQ','numberOfActiveRequests','href','typeOf','Number\x20of\x20cancelled\x20requests:\x20','CANCELLED','reserve','ACTIVE','numberOfCancelledActiveRequests','FAILED','push','url','resolve','requestFunction','reject','request','defineProperties','normalize','then','cancelled','lastNumberOfActiveRequests','requestHeap','numberOfActiveRequestsEver','numberOfAttemptedRequests','serverHasOpenSlots','promise','https','2211cWKFZG','5ktRphZ','296buFmAF','Number\x20of\x20cancelled\x20active\x20requests:\x20','throttleByServer','raiseEvent','cancelFunction','14580XybzoG','requestCompletedEvent','maximumRequests','443','deferred','serverKey','scheme','176NJpiGB','numberOfActiveRequestsByServer','throttleRequests','log','pop','numberOfFailedRequests','state','test','RECEIVED','priorityFunction','UNISSUED','update','maximumLength','location','3746gdtRXw','numberOfCancelledRequests','getServerKey','priority','24480703oddCcH','request.url','27IIZPcJ'];a215_0x1246=function(){return _0x18154a;};return a215_0x1246();}export default RequestScheduler;